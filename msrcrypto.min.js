//*******************************************************************************
//
//    Copyright 2014 Microsoft
//    
//    Licensed under the Apache License, Version 2.0 (the "License");
//    you may not use this file except in compliance with the License.
//    You may obtain a copy of the License at
//    
//        http://www.apache.org/licenses/LICENSE-2.0
//    
//    Unless required by applicable law or agreed to in writing, software
//    distributed under the License is distributed on an "AS IS" BASIS,
//    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
//    See the License for the specific language governing permissions and
//    limitations under the License.
//
//*******************************************************************************
var msrCryptoVersion="1.2",msrCrypto=msrCrypto||function(){"use strict";function dt(){function f(n){var t,i=null;if(arguments.length&&typeof arguments[0]!="number"){if(typeof arguments[0]=="object")for(i=new Array(n.length),t=0;t<n.length;t+=1)i[t]=n[t]}else for(i=new Array(n),t=0;t<n;t+=1)i[t]=0;return i}function it(n){for(var i=new Array(n.length),t=0;t<n.length;)i[t]=n[n.length-t-1],t+=1;return i}function st(n,t){var i,f,r,e;for(n=n.replace(/^\s+|\s+$/g,""),i=[0],f=[0],t=t||10,r=0;r<n.length;r+=1){if(e=parseInt(n[r],t),isNaN(e))throw new Error("Failed to convert string to integer in radix "+t.toString());v(i,t,f);b(f,[e],i);u(i)}return i}function ht(n,t){var l,a,y;if(t=t||10,r<=t)throw new Error("DIGIT_BASE is smaller than RADIX; cannot convert.");var p=n.length,h=[],v=[],w=[],b=[],o=[],e=[],f,i="",c="0";for(o[0]=t;Math.floor(r/o[0])>=t;)o[0]=o[0]*t,c=c.concat("0");for(f=0;f<p;f+=1)e[f]=n[f];do{for(l=!0,f=0;f<e.length;f+=1)if(e[f]!==0){l=!1;break}if(l)break;s(e,o,h,v,w,b);u(h,e.length,!0);a=v[0].toString(t);i=c.substring(0,c.length-a.length)+a+i;y=e;e=h;h=y}while(1);while(i.length!==0&&i[0]==="0")i=i.substring(1,i.length);return i.length===0&&(i="0"),i}function ct(n){var i=Math.ceil((n+1)/8),t=f(i);return t[0]=Math.pow(2,n%8),t}function lt(n){for(var r=f(n.length*8),u=0,i=n.length-1,t;i>=0;){for(t=0;t<8;){var e=1<<t,o=(n[i]&e)===e?1:0,s=8*(n.length-i-1)+t;o===1&&(u=s+1);r[s]=o;t+=1}i--}return r.slice(0,u)}function rt(n){for(var i=r>>>1,u=t;u-->0;){if((n&i)===i)break;i=i>>>1}return u}function at(n){for(var r=0,t=0,i,u;r<n.length;){if(t===0)for(i=7;i>=0&&t===0;)u=1<<i,(n[r]&u)===u&&(t=i+1),i--;else t+=8;r+=1}return t}function vt(n,r,u,f){var p=n.length*t,o,s,a=n.length,w=a-1,c,e;if(f.length!==p+1)throw"nafDigits length must = bitwidth + 1";if(r<=1)throw"w must be greater than 1";if(r>=t)throw"w must be less than "+t.toString();for(o=0;o<a;o+=1)u[o]=n[o];for(var h=0,b=(1<<r)-1,k=r-1,d=1<<r,nt=(1<<r-1)-1,v=0,y=l(u);!y;){if((u[0]&1)!=1)g(u,u),v++;else{if(c=u[0]&b,g(u,u,r,w+1),c>nt&&(c-=d),c<0&&(e=u[0]+1,u[0]=e&i,e=e>>t,e!==0))for(s=1;s<a;s+=1)if(e+=u[s],u[s]=e&i,e=e>>t,e===0)break;for(;v>0;v--)f[h]=0,h++;for(f[h]=c,h++,s=0;s<k;s+=1)v++}for(y=!0,o=0;o<a;o+=1)if(u[o]!==0){y=!1;break}}return h}function e(n,t,i,r,u){while(u-->0)i[r+u]=n[t+u]}function l(n){for(var t=0;t<n.length;t+=1)if(n[t]!==0)return!1;return!0}function yt(n){return(n[0]&1)==0}function pt(n,t){if(n.length!==t.length)return!1;for(var i=0;i<n.length;i+=1)if(n[i]!==t[i])return!1;return!0}function d(n){var o=Math.floor((n.length+h-1)/h),i=new Array(o),u;i[0]=0;var t=0,e=0,f=0;for(u=n.length-1;u>=0;--u)t=t+y[f++]*(n[u]&255),y[f]===r&&(f=0,i[e++]=t,t=0);return t!==0&&(i[e]=t),i}function wt(n,t,i){var u,f,e,r=[0];for(typeof t=="undefined"&&(t=!0),u=0;u<n.length;u+=1)for(e=n[u],f=0;f<h;f+=1)r[u*h+f]=e&255,e=Math.floor(e/256);if(r=it(r),i===undefined&&(i=1),t)while(r.length>i&&r[0]===0)r.shift();return r}function a(n,i){var f,u;for(typeof i=="undefined"&&(n<=1?i=1:(f=Math.log(n)/Math.LN2,i=Math.ceil(f/t))),u=[];n>0;)u.push(n%r),n=Math.floor(n/r);while(u.length<i)u.push(0);return u}function c(n){for(var t=n.length-1;t>=0;t--)if(n[t]!==undefined&&n[t]!==0)return t;return n[0]===0?-1:0}function o(n,t){var i=0,r=c(n)+1,u=c(t)+1;if(r>u)i=1;else if(u>r)i=-1;else while(r-->0&&i===0)i=n[r]-t[r];return i}function u(n,t,i){var r=c(n);if(n.length=t||r+1,i)while(++r<n.length)n[r]=0;return n.length<=0&&(n[0]=0,n.length=1),n}function g(n,r,u,f){var o,s,e;if(u===undefined)u=1;else if(u>=t||u<0)throw new Error("Invalid bit count for shiftRight");for(f===undefined&&(f=n.length),o=f-1,s=t-u,e=0;e<o;++e)r[e]=(n[e+1]<<s|n[e]>>>u)&i;r[o]=n[o]>>>u}function nt(n,r,u,f){var o,e;if(u===undefined)u=1;else if(u>=t||u<0)throw new Error("bit count must be smaller than DIGIT_BITS and positive in shiftLeft");for(f===undefined&&(f=n.length),o=t-u,r[f]=n[f-1]>>>t-u||r[f],e=f-1;e>0;e--)r[e]=(n[e]<<u|n[e-1]>>>o)&i;r[0]=n[0]<<u&i}function b(n,r,u){var s=n,o=r,h,f,e;for(r.length<n.length&&(s=r,o=n),h=s.length,f=0,e=0;e<h;e+=1)f+=s[e]+o[e],u[e]=f&i,f=f>>t;for(e=h;e<o.length;e+=1)f+=o[e],u[e]=f&i,f=f>>t;return u.length=o.length,f!==0&&(u[e]=f&i),f}function ut(n,r,u){var o=r.length,e,f;if(n.length<r.length&&(o=c(r),n.length<o))throw new Error("Subtrahend is longer than minuend, not supported.");for(f=0,e=0;e<o;e+=1)f+=n[e]-r[e],u[e]=f&i,f=f>>t;while(e<n.length)f+=n[e],u[e++]=f&i,f=f>>t;return f}function v(n,t,u){for(var s=typeof t=="number"?[t]:t,h=Math.max(n.length,s.length),e,o,f=0;f<h;f+=1)u[f]=0;for(f=0;f<s.length;f+=1){for(o=0,e=0;e<n.length;e+=1)o+=n[e]*s[f]+u[f+e],u[f+e]=o&i,o=Math.floor(o/r);u[n.length+f]=o&i}return u.length=n.length+s.length,u}function s(n,f,o,s,h,l){var b=c(n)+1,a=c(f)+1,g,k,tt,it,w,p,v,ut,d,y;if(b<a){e(n,0,s,0,n.length);s.length=n.length;u(s);o[0]=0;o.length=1;return}if(a===0||a===1&&f[a-1]===0)throw new Error("Division by zero.");else if(a===1){for(w=f[0],k=0,v=b-1;v>=0;--v)it=k*r+n[v],o[v]=it/w&i,k=it-o[v]*w&i;o.length=b;u(o);s[0]=k;s.length=1;return}for(ut=t-1-rt(f[a-1]),d=h||[],d.length=a,nt(f,d,ut,a),y=l||[],y.length=b,nt(n,y,ut,b),y[b]=y[b]||0,o.length=b-a+1,s.length=a,v=b-a;v>=0;--v){for(g=Math.floor((y[v+a]*r+y[v+a-1])/d[a-1]),k=y[v+a]*r+y[v+a-1]-g*d[a-1];;)if(!(g>=r)&&!(g*d[a-2]>k*r+y[v+a-2])||(g=g-1,k=k+d[a-1],!(k<r)))break;for(tt=0,p=0;p<a;p++)it=g*d[p],w=y[p+v]-tt-(it&i),y[p+v]=w&i,tt=Math.floor(it/r)-Math.floor(w/r);if(w=y[v+a]-tt,y[v+a]=w&i,o[v]=g&i,w<0){for(o[v]=o[v]-1,tt=0,p=0;p<a;p++)w=y[p+v]+d[p]+tt,y[p+v]=w&i,tt=w>>t;y[v+a]=y[v+a]+tt&i}}for(p=0;p<a;p++)s[p]=(y[p]>>>ut|y[p+1]<<t-ut)&i;u(o);u(s)}function bt(n,t,i,r,u){return s(n,t,[],i,r,u),i}function ft(n,t,i,r,u,f){var e=[];return v(n,t,e),s(e,i,e,r,u,f),r}function et(n,t,i,r,f){var c,p,h,k;if(l(n))return e(t,0,f,0,t.length),f.length=t.length,0;if(l(t))return e(n,0,f,0,n.length),f.length=n.length,0;o(n,t)<0?(c=n.slice(0),e(t,0,f,0,t.length),f.length=t.length):(c=t.slice(0),e(n,0,f,0,n.length),f.length=n.length);u(f);u(c);var d=new Array(f.length),g=new Array(f.length),a=new Array(f.length),nt=r!==undefined,y;nt&&(y=new Array(f.length),y[0]=1,y.length=1,r[0]=0,r.length=1);h=new Array(f.length);k=i!==undefined;k&&(p=new Array(f.length),p[0]=0,p.length=1,i[0]=1,i.length=1);for(var tt=-1,it=i,rt=r,ut=f,w;!l(c);)s(f,c,d,g,h,a),k&&(v(d,p,h),b(h,i,h),u(h),w=i,i=p,p=h,h=w),nt&&(v(d,y,a),b(a,r,a),u(a),w=r,r=y,y=a,a=w),w=f,f=c,c=g,g=w,++tt;return k&&(e(i,0,it,0,i.length),it.length=i.length),nt&&(e(r,0,rt,0,r.length),rt.length=r.length),e(f,0,ut,0,f.length),ut.length=f.length,tt}function kt(n,t,i){var r=n,f=t;return o(n,t)>0&&(r=t,f=n),et(r,f,undefined,undefined,i),u(i)}function dt(n,t,i){var r=new Array(t.length),s=new Array(t.length),f=new Array(t.length),h=et(n,t,s,r,f);return i=i||[],o(f,w)!==0?(i[0]=NaN,i.length=1):((h&1)==1?ut(t,r,i):(e(r,0,i,0,r.length),i.length=r.length),u(i)),i}function gt(n,t,i,r){if(r=r||[],o(t,k)===0)r[0]=1;else if(o(t,w)===0)e(n,0,r,0,n.length),r.length=n.length;else{var f=new tt(i);u(n,f.s,!0);f.modExp(n,t,r);r.length=i.length}return r}function tt(n){function et(n){for(var f=1,r=2,u=3,e=u&n,o=2;o<=t;o+=1)r<e&&(f+=r),r=r<<1,u=u<<1|1,e=n*f&u;return(~f&i)+1}function b(n,u,f,e){var b,l;e=e||this;for(var c=0,a=e.m.length,v=a-1,k=e.mPrime,d=e.m0,g=n[0],s=0,y,p,h,w,o=0;o<a;o+=1)f[o]=0;for(o=0;o<a;o+=1){for(y=u[o],s=g*y+f[0],f[0]=s&i,s=Math.floor(s/r),h=1;h<a;h+=1)s=n[h]*y+f[h]+s,f[h]=s&i,s=Math.floor(s/r);for(c=c+s,p=f[0]*k&i,s=Math.floor((f[0]+d*p)/r),h=1,w=0;h<a;h+=1,w++)s=e.m[h]*p+f[h]+s,f[w]=s&i,s=Math.floor(s/r);c+=s;f[v]=c&i;c=Math.floor(c/r)}if(!(c===0&&f[v]<e.m[v])){for(b=e.temp1,l=0,o=0;o<a;o+=1)l=f[o]-e.m[o]+(l>>t),b[o]=l&i;if(l=(c&i)+(l>>t),l=(c>>>t)+(l>>t),l>>t!=-1){for(o=0;o<a;o+=1)f[o]=b[o];return}}}function ot(n){var i=f(n.length),t;for(this.montgomeryMultiply(n,this.rSquaredModm,i),t=0;t<this.s;t+=1)n[t]=i[t]}function st(n){this.montgomeryMultiply(n,this.one,this.temp1);for(var t=0;t<this.s;t+=1)n[t]=this.temp1[t]}function ht(n,r,f){for(var s=2,b=i>>>t-s,c,l,y,d,o=r.length-1;o>0&&r[o]===0;--o);for(c=o*t+rt(r[o])+1,c=c+(s-c%s),l=c%t-s,l<0&&(l+=t),y=b<<l,o=1;o<h.length;++o)ft(h[o-1],n,this.m,h[o],a,v),u(h[o],this.s,!0);var k=new Array(this.s),w=f,p=v;for(e(this.rModM,0,p,0,this.s);c>0;)this.montgomeryMultiply(p,p,w),this.montgomeryMultiply(w,w,k),d=(r[Math.floor((c-1)/t)]&y)>>>l,this.montgomeryMultiply(k,h[d],p),c=c-s,l=l-s,y=y>>>s,y===0&&(y=b<<t-s,l=t-s);return this.montgomeryMultiply(p,this.one,f),f}var l=n,y=l[0],o=l.length,k=f(o),w,ut,h;k[0]=1;var d=et(y),g=f(2*o+1),p=f(o+1),a=f(2*o+1),v=f(2*o+1),nt=p;nt[o]=1;s(nt,l,g,p,a,v);var tt=u(p,o,!0),c=f(2*o+1),it=c;return it[o*2]=1,s(it,l,g,c,a,v),u(c,o,!0),w=f(o),ut={m:l,mPrime:d,m0:y,temp1:a},b(c,c,w,ut),h=new Array(4),h[0]=tt,h[1]=new Array(o),h[2]=new Array(o),h[3]=new Array(o),{m:n,m0:y,mPrime:d,rSquaredModm:c,s:o,rModM:tt,rCubedModm:w,one:k,temp1:a,convertToMontgomeryForm:ot,convertToStandardForm:st,montgomeryMultiply:b,modExp:ht}}function ni(r){function w(t){var i=d(t);if(n.compareDigits(i,this.m_modulus)>=0)throw new Error("The number provided is not an element of this group");return u(i,this.m_digitWidth,!0),s(i,this)}function b(n){var t=a(n,this.m_digitWidth);return s(t,this)}function k(t){return n.normalizeDigitArray(t,this.m_digitWidth,!0),s(t,this)}function g(n){return o(this.m_modulus,n.m_modulus)===0}function nt(r,u,f){var e,c=this.m_digitWidth,h=f.m_digits,l,s;for(n.add(r.m_digits,u.m_digits,h),l=o(h,this.m_modulus)>=0?i:0,s=0,e=0;e<c;e+=1)s=h[e]-(this.m_modulus[e]&l)+s,h[e]=s&i,s=s>>t;h.length=c}function it(r,u,f){var e,h=this.m_digitWidth,s=f.m_digits,o=n.subtract(r.m_digits,u.m_digits,f.m_digits);if(o===-1)for(o=0,e=0;e<h;e+=1)o+=s[e]+this.m_modulus[e],s[e]=o&i,o=o>>t}function rt(t,i){n.modInv(t.m_digits,this.m_modulus,i.m_digits)}function ut(t,i,r){return n.modMul(t.m_digits,i.m_digits,this.m_modulus,r.m_digits,v,y)}function ft(n,t,i){if(i=i||s([],this),o(t,c)===0)i.m_digits=a(1,this.m_digitWidth);else if(o(t,l)===0){for(var r=0;r<n.m_digits.length;r++)i.m_digits[r]=n.m_digits[r];i.m_digits.length=n.m_digits.length}else this.montmul.modExp(n.m_digits,t,i.m_digits),i.m_digits.length=this.montmul.s;return i}function s(n,t){return{m_digits:n,m_group:t,equals:function(n){return o(this.m_digits,n.m_digits)===0&&this.m_group.equals(this.m_group,n.m_group)}}}var h=d(r),e=h.length,c=a(0,e),l=a(1,e),v=f(e),y=f(e),p=new tt(h);return{m_modulus:h,m_digitWidth:e,montmul:p,createElementFromInteger:b,createElementFromBytes:w,createElementFromDigits:k,equals:g,add:nt,subtract:it,multiply:ut,inverse:rt,modexp:ft}}for(var k,w,t=24,h=Math.floor(t/8),i=(1<<t)-1,r=1<<t,ot=i,y=[1,256],p=2;p<=h;++p)y[p]=y[p-1]*256;return k=[0],w=[1],{DIGIT_BITS:t,DIGIT_NUM_BYTES:h,DIGIT_MASK:i,DIGIT_BASE:r,DIGIT_MAX:ot,Zero:k,One:w,normalizeDigitArray:u,swapEndianness:it,bytesToDigits:d,stringToDigits:st,digitsToString:ht,intToDigits:a,digitsToBytes:wt,sequenceEqual:pt,isZero:l,isEven:yt,powerOfTwo:ct,shiftRight:g,shiftLeft:nt,compareDigits:o,computeBitArray:lt,bitLength:at,computeNAF:vt,IntegerGroup:ni,add:b,subtract:ut,multiply:v,divRem:s,reduce:bt,modInv:dt,modExp:gt,modMul:ft,MontgomeryMultiplier:tt,gcd:kt}}function gt(){function t(n){var t,i=null;if(arguments.length&&typeof arguments[0]!="number"){if(typeof arguments[0]=="object")for(i=[],t=0;t<n.length;t+=1)i[t]=n[t]}else for(i=[],t=0;t<n;t+=1)i[t]=0;return i}var u=n.bytesToDigits,h=i,e=function(t,i,u,f,e,o){var s=t.length,h=r(this,!1,e,o,null,!1);return{p:t,a:i,b:u,order:f,generator:h,allocatePointStorage:function(){return r(this,!1,n.intToDigits(0,s),n.intToDigits(0,s))},createPointAtInfinity:function(){return r(this,!0,n.intToDigits(0,s),n.intToDigits(0,s))}}},o=function(t,i,r,u,f){var s=n.intToDigits(3,t.length),o;return n.subtract(t,s,s),o=e(t,s,i,r,u,f),o.generator.curve=o,o},s={"256":{size:32,data:"/////wAAAAEAAAAAAAAAAAAAAAD///////////////9axjXYqjqT57PrvVV2mIa8ZR0GsMxTsPY7zjw+J9JgS/////8AAAAA//////////+85vqtpxeehPO5ysL8YyVRaxfR8uEsQkf4vOblY6RA8ncDfYEt6zOg9KE5RdiYwpZP40Li/hp/m47n60p8D54WK84zV2sxXs7LtkBoN79R9Q=="},"384":{size:48,data:"//////////////////////////////////////////7/////AAAAAAAAAAD/////szEvp+I+5+SYjgVr4/gtGRgdnG7+gUESAxQIj1ATh1rGVjmNii7RnSqFyO3T7Crv////////////////////////////////x2NNgfQ3Ld9YGg2ySLCneuzsGWrMxSlzqofKIr6LBTeOscce8yCtdG4dO2KLp5uYWfdB4IJUKjhVAvJdv1UpbDpUXjhydgq3NhfeSpYmLG9dnpi/kpLcKfj0Hb0omhR86doxE7XwuMAKYLHOHX6BnXpDHXyQ6g5f"},"521":{size:32,data:"Af//////////////////////////////////////////////////////////////////////////////////////UZU+uWGOHJofkpohoLaFQO6i2nJbmbMV87i0iZGO8QnhVhk5Uex+k3sWUsC9O7G/BzVz34g9LDTx70Uf1GtQPwAB///////////////////////////////////////////6UYaHg78vlmt/zAFI9wml0Du1ybiJnEeuu2+3HpE4ZAnGhY4GtwQE6c2ePstmI5W0QpxkgTkFP7Uh+CivYGtNPbqhS1537+dZKP4dwSei/6jeM0izwYVqQpv5fn4xwuW9ZgEYOSlqeJo7wARcil+0LH0b2Zj1RElXm0RoF6+9Fyc+ZiyX7nKZXvQmQMVQuQE/rQdhNTxwhqJywkCIvpR2n9FmUA=="}},c=function(){return f("256")},l=function(){return f("384")},w=function(){return f("521")},f=function(n){var t=h.unpackData(s[n].data,s[n].size),i=o(u(t[0]),u(t[1]),u(t[2]),u(t[3]),u(t[4]));return i.name="P-"+n,i},a=function(){return e(n.stringToDigits("16798108731015832284940804142231733909889187121439069848933715426072753864723",10),n.intToDigits(0,16),n.intToDigits(2,16),n.stringToDigits("16798108731015832284940804142231733909759579603404752749028378864165570215949",10),n.stringToDigits("16798108731015832284940804142231733909889187121439069848933715426072753864722",10),n.intToDigits(1,16))},r=function(i,u,f,e,o,s){function c(t){return t?h.isInfinity&&t.isInfinity?!0:h.z===null&&t.z!==null?!1:h.z!==null&&t.z===null?!1:h.z===null?n.sequenceEqual(h.x,t.x)&&n.sequenceEqual(h.y,t.y)&&h.isInMontgomeryForm===t.isInMontgomeryForm:n.sequenceEqual(h.x,t.x)&&n.sequenceEqual(h.y,t.y)&&n.sequenceEqual(h.z,t.z)&&h.isInMontgomeryForm===t.isInMontgomeryForm:!1}function l(n,t){if(t.curve=n.curve,t.x=n.x.slice(),t.y=n.y.slice(),t.z=n.z!==null?n.z.slice():null,nt||(t.isAffine=n.isAffine),t.isInMontgomeryForm=n.isInMontgomeryForm,t.isInfinity=n.isInfinity,!t.equals(n))throw new Error("Instances should be equal.");}function a(){return h.z===null?r(h.curve,h.isInfinity,t(h.x),t(h.y),null,h.isInMontgomeryForm):r(h.curve,h.isInfinity,t(h.x),t(h.y),t(h.z),h.isInMontgomeryForm)}var h;return typeof o=="undefined"&&(o=null),typeof s=="undefined"&&(s=!1),h={equals:function(n){return c(n)},copy:function(n){l(this,n);return},clone:function(){return a()}},k(h,"curve",i,function(){return i},function(n){i=n}),k(h,"x",f,function(){return f},function(n){f=n}),k(h,"y",e,function(){return e},function(n){e=n}),k(h,"z",o,function(){return o},function(n){o=n}),k(h,"isInMontgomeryForm",s,function(){return s},function(n){s=n}),k(h,"isInfinity",u,function(){return u},function(n){u=n}),k(h,"isAffine",o===null,function(){return o===null}),h},v=function(u){function h(n,t,i){var r=k.createElementFromInteger(0);r.m_digits=i;k.subtract(k.createElementFromDigits(n),k.createElementFromDigits(t),r)}function w(n,t,i){var r=k.createElementFromInteger(0);r.m_digits=i;k.add(k.createElementFromDigits(n),k.createElementFromDigits(t),r)}function ht(t,i){n.modInv(t,vt.p,i)}function ut(t,i){var e=t.length,o=u.p,r,f;if((t[0]&1)==1){for(r=0,f=0;f<e;f+=1)r+=t[f]+o[f],i[f]=r&n.DIGIT_MASK,r=r>>>n.DIGIT_BITS;r=r<<n.DIGIT_BITS-1;n.shiftRight(i,i);i[e-1]|=r}else n.shiftRight(t,i)}function e(n,t,i){p.montgomeryMultiply(n,t,i)}function l(n,t){p.montgomeryMultiply(n,n,t)}function ct(n){var r=t(n.length),i;for(e(n,p.rCubedModm,r),i=0;i<r.length;i+=1)n[i]=r[i]}function yt(n,t){if(n.isInfinity){t.isInfinity=!0;return}l(n.z,a);l(n.y,o);w(n.x,a,f);h(n.x,a,a);w(a,a,s);w(s,a,s);e(n.x,o,v);e(f,s,a);l(o,s);ut(a,f);l(f,o);e(n.y,n.z,g);for(var i=0;i<g.length;i+=1)t.z[i]=g[i];h(o,v,t.x);h(t.x,v,t.x);h(v,t.x,o);e(f,o,v);h(v,s,t.y);t.isInfinity=!1;t.isInMontgomeryForm=!0}function pt(n,t){if(n.isInfinity){t.isInfinity=!0;return}l(n.y,o);l(n.x,a);w(a,a,s);w(s,a,a);e(n.x,o,v);l(o,s);ut(a,f);l(f,o);e(n.y,n.z,g);for(var i=0;i<g.length;i+=1)t.z[i]=g[i];h(o,v,t.x);h(t.x,v,t.x);h(v,t.x,a);e(f,a,c);h(c,s,t.y);t.isInfinity=!1;t.isInMontgomeryForm=!0}function lt(n,t){if(n<4)throw new Error("This pre-computation algorithm assumes w >= 4");if(!t.isInMontgomeryForm)throw new Error("Generator point must be in montgomery form");if(!t.isAffine)throw new Error("Generator point must be in affine form");return st?bt(n,t):wt(n,t)}function wt(n,i){var b=u.p.length,ft=1<<n-2,a=[],v,et,k,tt,d,y,g,p,it;for(a[0]=i.clone(),v=1;v<ft;v+=1)et=r(u,!1,t(b),t(b),t(b),!0),a[v]=et;for(k=[],tt=[],v=0;v<ft-2;v+=1)k[v]=t(b),tt[v]=t(b);for(d=rt,l(a[0].x,f),l(a[0].y,o),w(f,f,c),w(c,f,f),w(f,ot,f),ut(f,f),e(o,a[0].x,a[2].x),l(o,a[2].y),v=0;v<b;v+=1)d[v]=a[0].y[v];for(l(f,a[1].x),h(a[1].x,a[2].x,a[1].x),h(a[1].x,a[2].x,a[1].x),h(a[2].x,a[1].x,c),e(f,c,s),h(s,a[2].y,a[1].y),h(a[2].x,a[1].x,f),h(a[2].y,a[1].y,c),e(d,f,s),y=0;y<b;y++)d[y]=s[y];for(l(f,k[0]),l(c,o),e(k[0],a[1].x,a[2].x),h(o,a[2].x,o),h(o,a[2].x,o),e(k[0],f,s),y=0;y<b;y++)k[0][y]=s[y];for(h(o,k[0],a[1].x),h(a[2].x,a[1].x,f),e(f,c,s),e(a[1].y,k[0],a[2].y),h(s,a[2].y,a[1].y),v=0;v<ft-3;v+=1){for(g=v+1,p=v+2,it=v+3,h(a[g].x,a[p].x,f),h(a[g].y,a[p].y,c),e(d,f,s),y=0;y<b;y++)d[y]=s[y];l(f,k[v]);l(c,o);e(k[v],a[p].x,a[it].x);h(o,a[it].x,o);h(o,a[it].x,o);e(k[v],f,tt[v]);h(o,tt[v],a[p].x);h(a[it].x,a[p].x,s);e(s,c,f);e(a[p].y,tt[v],a[it].y);h(f,a[it].y,a[p].y)}for(v=ft-3,g=v+1,p=v+2,h(a[g].x,a[p].x,f),h(a[g].y,a[p].y,c),e(d,f,s),y=0;y<b;y++)d[y]=s[y];for(l(f,k[v]),l(c,o),e(k[v],f,tt[v]),e(k[v],a[p].x,f),h(o,f,o),h(o,f,o),h(o,tt[v],a[p].x),h(f,a[p].x,s),e(s,c,f),e(a[p].y,tt[v],o),h(f,o,a[p].y),ht(d,d),ct(d),l(d,f),e(f,d,c),e(a[p].x,f,s),y=0;y<b;y++)a[p].x[y]=s[y];for(e(a[p].y,c,s),y=0;y<b;y++)a[p].y[y]=s[y];for(v=ft-3;v>=0;v--){for(g=v+1,e(f,k[v],s),y=0;y<b;y++)f[y]=s[y];for(e(c,tt[v],s),y=0;y<b;y++)c[y]=s[y];for(e(a[g].x,f,s),y=0;y<b;y++)a[g].x[y]=s[y];for(e(a[g].y,c,s),y=0;y<b;y++)a[g].y[y]=s[y]}for(v=0;v<a.length;v+=1)a[v].z=null,nt||(a[v].isAffine=!0);for(v=0;v<a.length;v+=1){if(!a[v].isAffine)throw new Error("Non-affine povar found in precomputation table");a[v].isInMontgomeryForm||at(a[v])}return a}function bt(n,i){var b=u.p.length,ft=1<<n-2,a=[],v,et,k,tt,d,y,g,p,it;for(a[0]=i.clone(),v=1;v<ft;v+=1)et=r(u,!1,t(b),t(b),t(b),!0),a[v]=et;for(k=[],tt=[],v=0;v<ft-2;v+=1)k[v]=t(b),tt[v]=t(b);for(d=rt,l(a[0].x,f),l(a[0].y,o),w(f,f,c),w(c,f,f),ut(f,f),e(o,a[0].x,a[2].x),l(o,a[2].y),v=0;v<b;v+=1)d[v]=a[0].y[v];for(l(f,a[1].x),h(a[1].x,a[2].x,a[1].x),h(a[1].x,a[2].x,a[1].x),h(a[2].x,a[1].x,c),e(f,c,s),h(s,a[2].y,a[1].y),h(a[2].x,a[1].x,f),h(a[2].y,a[1].y,c),e(d,f,s),y=0;y<b;y++)d[y]=s[y];for(l(f,k[0]),l(c,o),e(k[0],a[1].x,a[2].x),h(o,a[2].x,o),h(o,a[2].x,o),e(k[0],f,s),y=0;y<b;y++)k[0][y]=s[y];for(h(o,k[0],a[1].x),h(a[2].x,a[1].x,f),e(f,c,s),e(a[1].y,k[0],a[2].y),h(s,a[2].y,a[1].y),v=0;v<ft-3;v+=1){for(g=v+1,p=v+2,it=v+3,h(a[g].x,a[p].x,f),h(a[g].y,a[p].y,c),e(d,f,s),y=0;y<b;y++)d[y]=s[y];l(f,k[v]);l(c,o);e(k[v],a[p].x,a[it].x);h(o,a[it].x,o);h(o,a[it].x,o);e(k[v],f,tt[v]);h(o,tt[v],a[p].x);h(a[it].x,a[p].x,s);e(s,c,f);e(a[p].y,tt[v],a[it].y);h(f,a[it].y,a[p].y)}for(v=ft-3,g=v+1,p=v+2,h(a[g].x,a[p].x,f),h(a[g].y,a[p].y,c),e(d,f,s),y=0;y<b;y++)d[y]=s[y];for(l(f,k[v]),l(c,o),e(k[v],f,tt[v]),e(k[v],a[p].x,f),h(o,f,o),h(o,f,o),h(o,tt[v],a[p].x),h(f,a[p].x,s),e(s,c,f),e(a[p].y,tt[v],o),h(f,o,a[p].y),ht(d,d),ct(d),l(d,f),e(f,d,c),e(a[p].x,f,s),y=0;y<b;y++)a[p].x[y]=s[y];for(e(a[p].y,c,s),y=0;y<b;y++)a[p].y[y]=s[y];for(v=ft-3;v>=0;v--){for(g=v+1,e(f,k[v],s),y=0;y<b;y++)f[y]=s[y];for(e(c,tt[v],s),y=0;y<b;y++)c[y]=s[y];for(e(a[g].x,f,s),y=0;y<b;y++)a[g].x[y]=s[y];for(e(a[g].y,c,s),y=0;y<b;y++)a[g].y[y]=s[y]}for(v=0;v<a.length;v+=1)a[v].z=null,nt||(a[v].isAffine=!0);for(v=0;v<a.length;v+=1){if(!a[v].isAffine)throw new Error("Non-affine povar found in precomputation table");a[v].isInMontgomeryForm||at(a[v])}return a}function at(n){if(n.isInMontgomeryForm)throw new Error("The given point is already in montgomery form.");n.isInfinity||(p.convertToMontgomeryForm(n.x),p.convertToMontgomeryForm(n.y),n.z!==null&&p.convertToMontgomeryForm(n.z));n.isInMontgomeryForm=!0}var vt=u,y=u.p.length,p=n.MontgomeryMultiplier(u.p),ot=u.a.slice();p.convertToMontgomeryForm(ot);var st=n.isZero(u.a),ft=n.One,it=t(y);it[0]=1;p.convertToMontgomeryForm(it);var k=n.IntegerGroup(n.digitsToBytes(p.m),!0),s=t(y),f=t(y),c=t(y),o=t(y),a=t(y),v=t(y),b=t(y),rt=t(y),g=t(y),et=t(y),d=t(y),tt=t(y);return{double:function(n,t){if(typeof n=="undefined")throw new Error("point undefined");if(typeof t=="undefined")throw new Error("outputPoint undefined");if(n.isAffine)throw new Error("Given point was in Affine form. Use convertToJacobian() first.");if(!n.isInMontgomeryForm)throw new Error("Given point must be in montgomery form. Use montgomeryize() first.");if(t.isAffine)throw new Error("Given output point was in Affine form. Use convertToJacobian() first.");st?pt(n,t):yt(n,t)},mixedDoubleAdd:function(n,t,i){if(n.isInfinity){t.copy(i);this.convertToJacobianForm(i);return}if(t.isInfinity){n.copy(i);return}l(n.z,v);e(n.z,v,b);e(t.x,v,a);e(t.y,b,v);h(a,n.x,f);h(v,n.y,c);l(c,a);l(f,b);e(b,n.x,v);e(f,b,s);h(a,v,o);h(o,v,o);e(n.z,f,a);h(o,v,o);e(s,n.y,b);h(o,s,o);w(b,b,f);e(a,o,i.z);e(c,o,a);l(o,s);w(f,a,f);e(s,v,a);l(f,rt);e(s,o,v);h(rt,a,i.x);h(i.x,a,i.x);h(i.x,v,i.x);h(i.x,a,o);e(v,b,s);e(f,o,a);h(a,s,i.y);i.isInfinity=!1;i.isInMontgomeryForm=!0},mixedAdd:function(n,t,i){var r,u;if(n===null)throw new Error("jacobianPoint");if(t===null)throw new Error("affinePoint");if(i===null)throw new Error("outputPoint");if(n.curve!==t.curve||n.curve!==i.curve)throw new Error("All points must be from the same curve object.");if(n.isAffine)throw new Error("Given jacobianPoint was in Affine form. Use ConvertToJacobian() before calling DoubleJacobianAddAffinePoints().");if(!t.isAffine)throw new Error("Given affinePoint was in Jacobian form. Use ConvertToAffine() before calling DoubleJacobianAddAffinePoints().");if(i.isAffine)throw new Error("Given jacobianPoint was in Jacobian form. Use ConvertToJacobian() before calling DoubleJacobianAddAffinePoints().");if(!n.isInMontgomeryForm)throw new Error("Jacobian point must be in Montgomery form");if(!t.isInMontgomeryForm)throw new Error("Affine point must be in Montgomery form");if(n.isInfinity){t.copy(i);this.convertToJacobianForm(i);return}if(t.isInfinity){n.copy(i);return}for(l(n.z,f),e(f,n.z,c),e(f,t.x,o),e(c,t.y,a),h(o,n.x,f),h(a,n.y,c),r=0;r<f.length;r+=1)if(f[r]!==0){for(e(n.z,f,s),u=0;u<y;u+=1)i.z[u]=s[u];l(f,o);e(o,f,a);e(o,n.x,v);w(v,v,f);l(c,i.x);h(i.x,f,i.x);h(i.x,a,i.x);h(v,i.x,o);e(c,o,v);e(n.y,a,b);h(v,b,i.y);i.isInfinity=!1;i.isInMontgomeryForm=!0;return}for(r=0;r<c.length;r+=1)if(c[r]!==0){i.isInfinity=!0;i.isInMontgomeryForm=!0;return}t.copy(i);this.convertToJacobianForm(i);this.double(i,i);i.isInMontgomeryForm=!0},scalarMultiply:function(t,r,f){var o;if(r.isInfinity||n.isZero(t)){f.isInfinity=!0;return}if(n.compareDigits(t,u.order)>=0)throw new Error("The scalar k must be in the range 1 <= k < order.");var e,l=y<=8?5:6,h=i.getVector(t.length*n.DIGIT_BITS+1),a=n.computeNAF(t,l,s,h),c=lt(l,r);for(f.isInfinity=!0,o=a-1;o>=0;o--)h[o]===0?this.double(f,f):h[o]<0?(e=-h[o]>>1,this.negate(c[e],c[e]),this.mixedDoubleAdd(f,c[e],f),this.negate(c[e],c[e])):h[o]>0&&(e=h[o]>>1,this.mixedDoubleAdd(f,c[e],f));return},negate:function(t,i){t!==i&&t.copy(i);n.subtract(t.curve.p,t.y,i.y)},convertToMontgomeryForm:function(n){if(n.isInMontgomeryForm)throw new Error("The given point is already in montgomery form.");n.isInfinity||(p.convertToMontgomeryForm(n.x),p.convertToMontgomeryForm(n.y),n.z!==null&&p.convertToMontgomeryForm(n.z));n.isInMontgomeryForm=!0},convertToStandardForm:function(n){if(!n.isInMontgomeryForm)throw new Error("The given point is not in montgomery form.");n.isInfinity||(p.convertToStandardForm(n.x),p.convertToStandardForm(n.y),n.z!==null&&p.convertToStandardForm(n.z));n.isInMontgomeryForm=!1},convertToAffineForm:function(t){var r,i;if(t.isInfinity){t.z=null;nt||(t.isAffine=!0);return}for(n.modInv(t.z,u.p,tt),t.isInMontgomeryForm&&(e(tt,p.rCubedModm,d),r=tt,tt=d,d=r),l(tt,et),e(t.x,et,d),i=0;i<y;i+=1)t.x[i]=d[i];e(t.y,et,d);e(d,tt,t.y);t.z=null;nt||(t.isAffine=!0)},convertToJacobianForm:function(n){if(!n.isAffine)throw new Error("The given point is not in Affine form.");nt||(n.isAffine=!1);var r,i;if(n.isInMontgomeryForm){for(r=t(it.length),i=0;i<it.length;i+=1)r[i]=it[i];n.z=r}else{for(r=t(ft.length),i=0;i<ft.length;i+=1)r[i]=ft[i];n.z=r}},generatePrecomputationTable:function(n,t){return lt(n,t)}}},y=function(){return{encodePoint:function(i){var f,s,r;if(!i)throw new Error("point");if(!i.isAffine)throw new Error("Point must be in affine form.");if(i.isInMontgomeryForm)throw new Error("Point must not be in Montgomery form.");if(i.isInfinity)return t(1);var e=n.digitsToBytes(i.x),o=n.digitsToBytes(i.y),h=n.digitsToBytes(i.curve.p),u=h.length;if(u<e.length||u<o.length)throw new Error("Point coordinate(s) are bigger than the field order.");for(f=t(2*u+1),f[0]=4,s=u-e.length,r=0;r<e.length;r++)f[r+1+s]=e[r];for(s=u-o.length,r=0;r<o.length;r++)f[u+r+1+s]=o[r];return f},decodePoint:function(i,u){var h,e,o,s,f,c,l;if(i.length<1)throw new Error("Byte array must have non-zero length");if(h=n.digitsToBytes(u.p),e=h.length,i[0]===0&&i.length===1)return u.createPointAtInfinity();if(i[0]===4&&i.length===1+2*e){for(o=t(e),s=t(e),f=0;f<e;f++)o[f]=i[f+1],s[f]=i[e+f+1];return c=n.bytesToDigits(o),l=n.bytesToDigits(s),r(u,!1,c,l)}throw new Error("Unsupported encoding format");}}},p=function(t){function o(t){var i=n.intToDigits(0,16),f;return(u.modExp(t,r,i),f=[0],n.modMul(i,i,u.m,f),n.compareDigits(t,f)!==0)?null:i}var i=t,r=[],u,f,e;if(typeof t=="undefined")throw new Error("modulus");if(n.isEven(t))throw new Error("Only odd moduli are supported");return u=n.MontgomeryMultiplier(i),i[0]%4==3?(n.add(i,n.One,r),n.shiftRight(r,r,2)):r=null,f=new Array(i.length),e=new Array(i.length),{squareRoot:function(n){if(r!==null)return o(n);throw new Error("GeneralCase not supported.");},jacobiSymbol:function(t){var h=3,r,u,o,s,c,l,a;for(r=t.slice(),u=i.slice(),n.reduce(r,u,r,f,e),o=1;!n.isZero(r);){while(n.isEven(r))n.shiftRight(r,r),s=u[0]&7,(s===3||s===5)&&(o=-o);c=r;r=u;u=c;l=r[0]&h;a=u[0]&h;l===3&&a===3&&(o=-o);n.reduce(r,u,r,f,e)}return n.compareDigits(u,n.One)===0?o:0}}};return{createP256:c,createP384:l,createBN254:a,createANeg3Curve:o,sec1EncodingFp:y,EllipticCurvePointFp:r,EllipticCurveOperatorFp:v,ModularSquareRootSolver:p}}function ct(){function s(n){for(var t=n.length-1;t>=0;t-=1)if(n[t]+=1,n[t]>=256&&(n[t]=0),n[t])break}function h(){r=i.getVector(32);t=i.getVector(16);e=32;n=48;u=1}function c(t,r){var f,e;if(r=r||[0],r.length>n)throw new Error("Incorrect entropy or additionalEntropy length");for(r=r.concat(i.getVector(n-r.length)),t=t.concat(i.getVector((n-t.length%n)%n)),f=0;f<t.length;f+=n)e=i.xorVectors(t.slice(f,f+n),r),o(e);u=1}function o(u){for(var f=[],c=new g.aes(r),o,h;f.length<n;)s(t),o=t.slice(0,16),h=c.encrypt(o),f=f.concat(h);f=i.xorVectors(f,u);r=f.slice(0,e);t=f.slice(e)}function l(f,e){var h,c,l,v;if(f>=65536)throw new Error("too much random requested");if(u>a)throw new Error("Reseeding is required");if(e&&e.length>0){while(e.length<n)e=e.concat(i.getVector(n-e.length));o(e)}else e=i.getVector(n);for(h=[],c=new g.aes(r);h.length<f;)s(t),l=t.slice(0,t.length),v=c.encrypt(l),h=h.concat(v);return h=h.slice(0,f),o(e),u+=1,h}if(!(this instanceof ct))throw new Error("create MsrcryptoPrng object with new keyword");var f=!1,r,t,e,n,u=1,a=16777216;return h(),{reseed:c,init:function(t,i){if(t.length<n)throw new Error("Initial entropy length too short");h();c(t,i);f=!0},getBytes:function(n,t){if(!f)throw new Error("can't get randomness before initialization");return l(n,t)},getNonZeroBytes:function(n,t){var r,u,i;if(!f)throw new Error("can't get randomness before initialization");for(r=[];r.length<n;)for(u=l(n,t),i=0;i<u.length;i+=1)u[i]!==0&&r.push(u[i]);return r.slice(0,n)}}}function ni(){function s(){for(var s=[],c,l,v,a,y,h=0;h<e;h+=1)s[h]=Math.floor(Math.random()*256);for(c=window.crypto||window.msCrypto,c&&typeof c.getRandomValues=="function"&&window.Uint8Array&&(l=new window.Uint8Array(e),c.getRandomValues(l),s=s.concat(Array.apply(null,l)),u=!0),v=new XMLHttpRequest,h=0;h<o.length;h+=1)try{a=v.getResponseHeader(o[h]);a&&(y=i.stringToBytes(a),s=s.concat(y))}catch(p){}u||(s=s.concat(n.splice(0,n.length)),f.startCollectors());r?t.reseed(s):t.init(s);r=!0}function h(t){for(var i=0;i<t.length;++i)n.push(t[i]);n.length>=c&&f.stopCollectors()}var e=48,n=[],c=128,l=0,t=new ct,r=!1,u=!1,o=["Cookie","RedirectUri","ETag","x-ms-client-antiforgery-id","x-ms-client-request-id","x-ms-client-session-id","SubscriptionPool"],f=function(){return{startCollectors:function(){if(!this.collectorsRegistered){if(window.addEventListener)window.addEventListener("mousemove",this.MouseEventCallBack,!0),window.addEventListener("load",this.LoadTimeCallBack,!0);else if(document.attachEvent)document.attachEvent("onmousemove",this.MouseEventCallBack),document.attachEvent("onload",this.LoadTimeCallBack);else throw new Error("Can't attach events for entropy collection");this.collectorsRegistered=1}},stopCollectors:function(){this.collectorsRegistered&&(window.removeEventListener?(window.removeEventListener("mousemove",this.MouseEventCallBack,1),window.removeEventListener("load",this.LoadTimeCallBack,1)):window.detachEvent&&(window.detachEvent("onmousemove",this.MouseEventCallBack),window.detachEvent("onload",this.LoadTimeCallBack)),this.collectorsRegistered=0)},MouseEventCallBack:function(n){var t=(new Date).valueOf(),i=n.x||n.clientX||n.offsetX||0,r=n.y||n.clientY||n.offsetY||0,u=[t&255,t>>8&255,t>>16&255,t>>24&255,i&255,i>>8&255,r&255,r>>8&255];h(u)},LoadTimeCallBack:function(){var n=(new Date).valueOf(),t=[n&255,n>>8&255,n>>16&255,n>>24&255];h(t)}}}();return{init:function(){if(s(),!u&&!l)try{f.startCollectors()}catch(n){}},reseed:function(n){t.reseed(n)},read:function(n){if(!r)throw new Error("Entropy pool is not initialized.");var i=t.getBytes(n);return s(),i}}}var t={},l,n,b,d,a,v,f,g,st,p,e,y,o,s,w,r,it,rt,h,ut,u,pt,lt,ht,ft,wt;t.register=function(n,i,r){t[n]||(t[n]={});var u=t[n];u[i]||(u[i]=r)};t.exists=function(n,i){return t[n]?t[n][i]?!0:!1:!1};var at=function(){if(typeof document!="undefined")try{throw new Error;}catch(t){if(t.stack){var n=/\w+:\/\/(.+?\/)*.+\.js/.exec(t.stack);return n&&n.length>0?n[0]:null}}else if(typeof self!="undefined")return self.location.href;return null}(),bt=!1,vt=typeof Worker!="undefined",ot=typeof importScripts!="undefined",kt=typeof Uint8Array!="undefined",nt=function(){try{return Object.defineProperty({},"oncomplete",{}),!0}catch(n){return!1}}(),tt=vt,k=function(n,t,i,r,u){if(!nt){n[t]=i;return}var f={};r&&(f.get=r);u&&(f.set=u);Object.defineProperty(n,t,f)},c={},i=function(){function f(t,r){var f="",h,e,o,l,a,c,s,u;if(r||(r=!1),(t.pop||t.subarray)&&(t=String.fromCharCode.apply(null,t)),i)f=btoa(t);else for(u=0;u<t.length;u+=3)h=t.charCodeAt(u),e=t.charCodeAt(u+1),o=t.charCodeAt(u+2),l=h>>2,a=(h&3)<<4|e>>4,c=(e&15)<<2|o>>6,s=o&63,isNaN(e)?c=s=64:isNaN(o)&&(s=64),f=f+n.charAt(l)+n.charAt(a)+n.charAt(c)+n.charAt(s);return r?f.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,""):f}function e(n){if(i){for(n=n.replace(/-/g,"+").replace(/_/g,"/");n.length%4!=0;)n+="=";return atob(n)}return String.fromCharCode.apply(null,t(n))}function t(t){for(t=t.replace(/-/g,"+").replace(/_/g,"/");t.length%4!=0;)t+="=";var r=[],o,s,h,c,f,u,e,i;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),i=0;i<t.length;i+=4)c=n.indexOf(t.charAt(i)),f=n.indexOf(t.charAt(i+1)),u=n.indexOf(t.charAt(i+2)),e=n.indexOf(t.charAt(i+3)),o=c<<2|f>>4,s=(f&15)<<4|u>>2,h=(u&3)<<6|e,r.push(o),u!==64&&r.push(s),e!==64&&r.push(h);return r}function r(n){return Object.prototype.toString.call(n).slice(8,-1)}function o(n,t){var r="",i,u;for(typeof t=="undefined"&&(t=!1),i=0;i<n.length;i++)t&&i%4==0&&i!==0&&(r+="-"),u=n[i].toString(16).toUpperCase(),u.length===1&&(r+="0"),r+=u;return r}function s(n){for(var i=new Array(n.length),t=0;t<i.length;t++)i[t]=n.charCodeAt(t);return i}function h(n){n=n.replace(/\-/g,"");for(var t=[];n.length>=2;)t.push(parseInt(n.substring(0,2),16)),n=n.substring(2,n.length);return t}function c(n){var i={};for(var t in n)n.hasOwnProperty(t)&&(i[t]=n[t]);return i}function l(n,i,r){var e=t(n),f=[],u;if(isNaN(i))return e;for(u=0;u<e.length;u+=i)f.push(e.slice(u,u+i));if(r)for(u=0;u<f.length;u++)f[u]=(f[u][0]<<24)+(f[u][1]<<16)+(f[u][2]<<8)+f[u][3];return f}function u(n){return[n>>>24&255,n>>>16&255,n>>>8&255,n&255]}function a(n){for(var t=[],i=0;i<n.length;i++)t=t.concat(u(n[i]));return t}function v(n,t){for(var r=Math.min(n.length,t.length),u=new Array(r),i=0;i<r;i+=1)u[i]=n[i]^t[i];return u}function y(n,t){var r,i;for(t||(t=0),r=new Array(n),i=0;i<n;i+=1)r[i]=t;return r}function p(n){return n.pop?n:n.length===1?[n[0]]:Array.apply(null,n)}function w(n,t,i){while(n.length<i)n.push(t);return n}function b(n,t,i){while(n.length<i)n.unshift(t);return n}function k(n,t){var r=!0,i;for(n.length!==t.length&&(r=!1),i=0;i<n.length;i++)n[i]!==t[i]&&(r=!1);return r}function d(n){var t,i;if(r(n)!=="Array")return!1;for(i=0;i<n.length;i++)if(t=n[i],NaN(t)||t<0||t>255)return!1;return!0}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=typeof btoa!="undefined";return{toBase64:f,base64ToString:e,base64ToBytes:t,getObjectType:r,bytesToHexString:o,stringToBytes:s,unpackData:l,hexToBytesArray:h,int32ToBytes:u,int32ArrayToBytes:a,toArray:p,arraysEqual:k,clone:c,xorVectors:v,padEnd:w,padFront:b,getVector:y,verifyByteArray:d}}(),yt=function(){function n(n){return ot&&self.postMessage(n),n}return{jsCryptoRunner:function(i){var e=i.data.operationType,u,f,r;if(!t.exists(e,i.data.algorithm.name))throw new Error("unregistered algorithm.");return f=t[e][i.data.algorithm.name],r=i.data,r.operationSubType==="process"?(f(r),u=n({type:"process"})):u=n(f(r)),u}}}();ot&&(self.onmessage=function(n){if(n.data.prngSeed){var t=n.data.prngSeed;s.init(t);return}yt.jsCryptoRunner(n)});l=function(){function t(n){for(var t=[],i=0;i<n.length;i++)t[i]=n.charCodeAt(i);return t[t.length-1]===0&&t.pop(),t}function r(n){var t=n.algorithm.name.slice(0,3).toLowerCase();return t==="rsa"?"RSA":t==="ecd"?"EC":"oct"}function u(i,u){var f={},e,o;if(f.kty=r(i),f.extractable=i.extractable,u.pop)f.k=n.toBase64(u,!0);else for(e in u)u[e].pop&&(f[e]=n.toBase64(u[e],!0));return i.algorithm.namedCurve&&(f.crv=i.algorithm.namedCurve),o=JSON.stringify(f,null,"\t"),t(o)}function f(t,i,r){for(var e,o=String.fromCharCode.apply(null,t),f=JSON.parse(o),u=0;u<r.length;u+=1)e=f[r[u]],e&&(f[r[u]]=n.base64ToBytes(e));return f}var n=i;return{keyToJwk:u,jwkToKey:f}}();n=n||dt();b=b||gt();d=function(){var f=function(n,t,i,r,u){function c(n){for(var w=Math.floor(n.length/s),o,i,c,l,a,v,t,u,b,y,p=0;p<w;p++){for(t=0;t<16;t++)y=p*s+t*4,e[t]=n[y]<<24|n[y+1]<<16|n[y+2]<<8|n[y+3];for(v=16;v<80;v++)b=e[v-3]^e[v-8]^e[v-14]^e[v-16],e[v]=b<<1|b>>>31;for(o=f[0],i=f[1],c=f[2],l=f[3],a=f[4],t=0;t<20;t++)u=(o<<5|o>>>27)&4294967295,u+=i&c^~i&l,u=u+a+r[t]+e[t]&4294967295,a=l,l=c,c=(i<<30|i>>>2)&4294967295,i=o,o=u;for(t=20;t<40;t++)u=(o<<5|o>>>27)&4294967295,u+=i^c^l,u=u+a+r[t]+e[t]&4294967295,a=l,l=c,c=(i<<30|i>>>2)&4294967295,i=o,o=u;for(t=40;t<60;t++)u=(o<<5|o>>>27)&4294967295,u+=i&c^i&l^c&l,u=u+a+r[t]+e[t]&4294967295,a=l,l=c,c=(i<<30|i>>>2)&4294967295,i=o,o=u;for(t=60;t<80;t++)u=(o<<5|o>>>27)&4294967295,u+=i^c^l,u=u+a+r[t]+e[t]&4294967295,a=l,l=c,c=(i<<30|i>>>2)&4294967295,i=o,o=u;f[0]+=o&4294967295;f[1]+=i&4294967295;f[2]+=c&4294967295;f[3]+=l&4294967295;f[4]+=a&4294967295}return h+=w,n.slice(w*s)}function v(){for(var t=new Array(256),n=0,i=0;n<8;n+=1,i+=4)t[i]=f[n]>>>24,t[i+1]=f[n]>>>16&255,t[i+2]=f[n]>>>8&255,t[i+3]=f[n]&255;return t.slice(0,u/8)}function y(n){var r=s-n.length,t,u,i;for(r<=8&&(r+=s),t=n.slice(),t.push(128),u=1;u<r-4;u++)t.push(0);return i=(n.length+h*s)*8,t.push(i>>>24&255),t.push(i>>>16&255),t.push(i>>>8&255),t.push(i&255),t}function l(n){return n.pop?n:n.length===1?[n[0]]:Array.apply(null,n)}function p(n){return o=c(l(n)),a()}function w(n){o=o.concat(l(n));o.length>=64&&(o=c(o));return}function a(){if(c(y(o)).length!==0)throw new Error("buffer.length !== 0");var n=v();return o=[],f=i.slice(),h=0,n}var s=64,f=i.slice(),e=new Array(s),o=[],h=0;return{name:n,computeHash:p,process:w,finish:a,der:t,hashLen:u,maxMessageSize:4294967295}},t,r,u,n=i.unpackData;return r=n("Z0UjAe/Nq4mYutz+EDJUdsPS4fA=",4,1),t=n("WoJ5mVqCeZlagnmZWoJ5mVqCeZlagnmZWoJ5mVqCeZlagnmZWoJ5mVqCeZlagnmZWoJ5mVqCeZlagnmZWoJ5mVqCeZlagnmZWoJ5mVqCeZlu2euhbtnroW7Z66Fu2euhbtnroW7Z66Fu2euhbtnroW7Z66Fu2euhbtnroW7Z66Fu2euhbtnroW7Z66Fu2euhbtnroW7Z66Fu2euhbtnroY8bvNyPG7zcjxu83I8bvNyPG7zcjxu83I8bvNyPG7zcjxu83I8bvNyPG7zcjxu83I8bvNyPG7zcjxu83I8bvNyPG7zcjxu83I8bvNyPG7zcymLB1spiwdbKYsHWymLB1spiwdbKYsHWymLB1spiwdbKYsHWymLB1spiwdbKYsHWymLB1spiwdbKYsHWymLB1spiwdbKYsHWymLB1spiwdY",4,1),u=n("MCEwCQYFKw4DAhoFAAQU"),{sha1:f("SHA-1",u,r,t,160)}}();typeof t!="undefined"&&(d.hash=function(n){if(n.operationSubType==="process"){d.sha1.process(n.buffer);return}return n.operationSubType==="finish"?d.sha1.finish():d.sha1.computeHash(n.buffer)},t.register("digest","sha-1",d.hash));c["sha-1"]=d.sha1;a=function(){var r=function(n,t,i,r,u){function c(n){for(var nt=Math.floor(n.length/s),i,c,l,y,t,p,w,k,u,o,g,a,v,b,d=0;d<nt;d++){for(o=0;o<16;o++)b=d*s+o*4,e[o]=n[b]<<24|n[b+1]<<16|n[b+2]<<8|n[b+3];for(u=16;u<64;u++)v=e[u-15],a=e[u-2],e[u]=(a>>>17|a<<15)^(a>>>19|a<<13)^a>>>10,e[u]+=e[u-7],e[u]+=(v>>>7|v<<25)^(v>>>18|v<<14)^v>>>3,e[u]+=e[u-16];for(i=f[0],c=f[1],l=f[2],y=f[3],t=f[4],p=f[5],w=f[6],k=f[7],o=0;o<64;o++)g=k+((t>>>6|t<<26)^(t>>>11|t<<21)^(t>>>25|t<<7))+(t&p^~t&w)+r[o]+e[o],y+=g,g+=((i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10))+(i&(c^l)^c&l),k=w,w=p,p=t,t=y,y=l,l=c,c=i,i=g;f[0]+=i&4294967295;f[1]+=c&4294967295;f[2]+=l&4294967295;f[3]+=y&4294967295;f[4]+=t&4294967295;f[5]+=p&4294967295;f[6]+=w&4294967295;f[7]+=k&4294967295}return h+=nt,n.slice(nt*s)}function v(){for(var t=new Array(256),n=0,i=0;n<8;n+=1,i+=4)t[i]=f[n]>>>24,t[i+1]=f[n]>>>16&255,t[i+2]=f[n]>>>8&255,t[i+3]=f[n]&255;return t.slice(0,u/8)}function y(n){var r=s-n.length,t,u,i;for(r<=8&&(r+=s),t=n.slice(),t.push(128),u=1;u<r-4;u++)t.push(0);return i=(n.length+h*s)*8,t.push(i>>>24&255),t.push(i>>>16&255),t.push(i>>>8&255),t.push(i&255),t}function l(n){return n.pop?n:n.length===1?[n[0]]:Array.apply(null,n)}function p(n){return o=c(l(n)),a()}function w(n){o=o.concat(l(n));o.length>=64&&(o=c(o));return}function a(){if(c(y(o)).length!==0)throw new Error("buffer.length !== 0");var n=v();return o=[],f=i.slice(),h=0,n}var s=64,f=i.slice(),e=new Array(s),o=[],h=0;return{name:n,computeHash:p,process:w,finish:a,der:t,hashLen:u,maxMessageSize:4294967295}},t,u,f,e,o,n=i.unpackData;return u=n("wQWe2DZ81QcwcN0X9w5ZOf/ACzFoWBURZPmPp776T6Q",4,1),f=n("agnmZ7tnroU8bvNypU/1OlEOUn+bBWiMH4PZq1vgzRk",4,1),t=n("QoovmHE3RJG1wPvP6bXbpTlWwltZ8RHxkj+CpKscXtXYB6qYEoNbASQxhb5VDH3Dcr5ddIDesf6b3AanwZvxdOSbacHvvkeGD8GdxiQMocwt6SxvSnSEqlywqdx2+YjamD5RUqgxxm2wAyfIv1l/x8bgC/PVp5FHBspjURQpKWcntwqFLhshOE0sbfxTOA0TZQpzVHZqCruBwskuknIshaK/6KGoGmZLwkuLcMdsUaPRkugZ1pkGJPQONYUQaqBwGaTBFh43bAgnSHdMNLC8tTkcDLNO2KpKW5zKT2gub/N0j4LueKVjb4TIeBSMxwIIkL7/+qRQbOu++aP3xnF48g",4,1),e=n("MC0wDQYJYIZIAWUDBAIEBQAEHA"),o=n("MDEwDQYJYIZIAWUDBAIBBQAEIA"),{sha224:r("SHA-224",e,u,t,224),sha256:r("SHA-256",o,f,t,256)}}();typeof t!="undefined"&&(a.hash256=function(n){if(n.operationSubType==="process"){a.sha256.process(n.buffer);return}return n.operationSubType==="finish"?a.sha256.finish():a.sha256.computeHash(n.buffer)},a.hash224=function(n){if(n.operationSubType==="process"){a.sha224.process(n.buffer);return}return n.operationSubType==="finish"?a.sha224.finish():a.sha224.computeHash(n.buffer)},t.register("digest","sha-224",a.hash224),t.register("digest","sha-256",a.hash256));c["sha-224"]=a.sha224;c["sha-256"]=a.sha256;v=function(){function n(n,t,i,r,u){var f=t+r|0,e=f>>>0<r>>>0;u[0]=n+i+e|0;u[1]=f;return}var u=function(t,i,r,u,f){function l(t){for(var lt=Math.floor(t.length/h),r,k,v,y,d,g,f,s,i=[],at=[],b=[],vt,et=0;et<lt;et++){for(r=0;r<32;r++)vt=et*h+r*4,o[r]=t.slice(vt,vt+4),o[r]=o[r][0]<<24|o[r][1]<<16|o[r][2]<<8|o[r][3];for(r=32;r<160;r+=2)f=o[r-30],s=o[r-29],v=(f>>>1|s<<31)^(f>>>8|s<<24)^f>>>7,y=(s>>>1|f<<31)^(s>>>8|f<<24)^(s>>>7|f<<25),f=o[r-4],s=o[r-3],d=(f>>>19|s<<13)^(s>>>29|f<<3)^f>>>6,g=(s>>>19|f<<13)^(f>>>29|s<<3)^(s>>>6|f<<26),n(d,g,o[r-14],o[r-13],i),n(v,y,i[0],i[1],i),n(o[r-32],o[r-31],i[0],i[1],i),o[r]=i[0],o[r+1]=i[1];var p=e[0],w=e[1],nt=e[2],tt=e[3],it=e[4],rt=e[5],ut=e[6],ft=e[7],l=e[8],a=e[9],ot=e[10],st=e[11],ht=e[12],ct=e[13],yt=e[14],pt=e[15];for(k=0;k<160;k+=2)v=(l>>>14|a<<18)^(l>>>18|a<<14)^(a>>>9|l<<23),y=(a>>>14|l<<18)^(a>>>18|l<<14)^(l>>>9|a<<23),d=l&ot^ht&~l,g=a&st^ct&~a,n(yt,pt,v,y,i),n(d,g,u[k],u[k+1],at),n(i[0],i[1],o[k],o[k+1],b),n(at[0],at[1],b[0],b[1],b),n(b[0],b[1],ut,ft,i),ut=i[0],ft=i[1],y=(w>>>28|p<<4)^(p>>>2|w<<30)^(p>>>7|w<<25),v=(p>>>28|w<<4)^(w>>>2|p<<30)^(w>>>7|p<<25),g=w&(tt^rt)^tt&rt,d=p&(nt^it)^nt&it,n(b[0],b[1],v,y,i),v=i[0],y=i[1],n(d,g,v,y,i),v=i[0],y=i[1],yt=ht,pt=ct,ht=ot,ct=st,ot=l,st=a,l=ut,a=ft,ut=it,ft=rt,it=nt,rt=tt,nt=p,tt=w,p=v,w=y;n(e[0],e[1],p,w,i);e[0]=i[0];e[1]=i[1];n(e[2],e[3],nt,tt,i);e[2]=i[0];e[3]=i[1];n(e[4],e[5],it,rt,i);e[4]=i[0];e[5]=i[1];n(e[6],e[7],ut,ft,i);e[6]=i[0];e[7]=i[1];n(e[8],e[9],l,a,i);e[8]=i[0];e[9]=i[1];n(e[10],e[11],ot,st,i);e[10]=i[0];e[11]=i[1];n(e[12],e[13],ht,ct,i);e[12]=i[0];e[13]=i[1];n(e[14],e[15],yt,pt,i);e[14]=i[0];e[15]=i[1]}return c+=lt,t.slice(lt*h)}function p(){for(var t=[],n=0;n<16;n++)t=t.concat([e[n]>>>24,e[n]>>>16&255,e[n]>>>8&255,e[n]&255]);return t.slice(0,f/8)}function w(n){var r=h-n.length,t,u,i;for(r<=16&&(r+=h),t=n.slice(),t.push(128),u=1;u<r-4;u++)t.push(0);return i=(n.length+c*h)*8,t.push(i>>>24&255),t.push(i>>>16&255),t.push(i>>>8&255),t.push(i&255),t}function a(n){return n.slice?n:n.length===1?[n[0]]:Array.apply(null,n)}function v(){for(var n=0;n<r.length;n++)e[n]=r[n][0]<<24|r[n][1]<<16|r[n][2]<<8|r[n][3]}function b(n){return s=l(a(n)),y()}function k(n){s=s.concat(a(n));s.length>=64&&(s=l(s));return}function y(){if(s=l(w(s)),s.length!==0)throw new Error("buffer.length !== 0");var n=p();return s=[],v(),c=0,n}var h=128,e=[],o=[],s=[],c=0;return v(),{name:t,computeHash:b,process:k,finish:y,der:i,hashLen:f,maxMessageSize:4294967295}},e,f,r,o,s,h,c,t=i.unpackData;return e=t("y7udXcEFnthimikqNnzVB5FZAVowcN0XFS/s2PcOWTlnMyZn/8ALMY60SodoWBUR2wwuDWT5j6dHtUgdvvpPpA==",4),f=t("agnmZ/O8yQi7Z66FhMqnOzxu83L+lPgrpU/1Ol8dNvFRDlJ/reaC0ZsFaIwrPmwfH4PZq/tBvWtb4M0ZE34heQ",4),r=t("QoovmNcoriJxN0SRI+9lzbXA+8/sTTsv6bXbpYGJ27w5VsJb80i1OFnxEfG2BdAZkj+CpK8ZT5urHF7V2m2BGNgHqpijAwJCEoNbAUVwb74kMYW+TuSyjFUMfcPV/7Ticr5ddPJ7iW+A3rH+OxaWsZvcBqclxxI1wZvxdM9pJpTkm2nBnvFK0u++R4Y4TyXjD8GdxouM1bUkDKHMd6ycZS3pLG9ZKwJ1SnSEqm6m5INcsKncvUH71Hb5iNqDEVO1mD5RUu5m36uoMcZtLbQyELADJ8iY+yE/v1l/x77vDuTG4AvzPaiPwtWnkUeTCqclBspjUeADgm8UKSlnCg5ucCe3CoVG0i/8LhshOFwmySZNLG38WsQq7VM4DROdlbPfZQpzVIuvY952agq7PHeyqIHCyS5H7a7mknIshRSCNTuiv+ihTPEDZKgaZku8QjABwkuLcND4l5HHbFGjBlS+MNGS6BnW71IY1pkGJFVlqRD0DjWFV3EgKhBqoHAyu9G4GaTBFrjS0MgeN2wIUUGrUydId0zfjuuZNLC8teGbSKg5HAyzxclaY07YqkrjQYrLW5zKT3dj43NoLm/z1rK4o3SPgu5d77L8eKVjb0MXL2CEyHgUofCrcozHAggaZDnskL7/+iNjHiikUGzr3oK96b75o/eyxnkVxnF48uNyUyvKJz7O6iZhnNGGuMchwMIH6tp91s3g6x71fU9/7m7ReAbwZ6pyF2+6CmN9xaLImKYRP5gEvvkNrhtxCzUTHEcbKNt39SMEfYQyyqt7QMckkzyevgoVyb68Qx1nxJwQDUxMxdS+yz5Ctll/KZz8ZX4qX8tvqzrW+uxsRBmMSkdYFw==",4,1),o=t("MEEwDQYJYIZIAWUDBAICBQAEMA"),s=t("MFEwDQYJYIZIAWUDBAIDBQAEQA"),h=t("MC0wDQYJYIZIAWUDBAIFBQAEHA"),c=t("MDEwDQYJYIZIAWUDBAIGBQAEIA"),{sha384:u("SHA-384",o,e,r,384),sha512:u("SHA-512",s,f,r,512),sha512_224:u("SHA-512.224",h,f,r,224),sha512_256:u("SHA-512.256",c,f,r,256)}}();typeof t!="undefined"&&(v.hash384=function(n){if(n.operationSubType==="process"){v.sha384.process(n.buffer);return}return n.operationSubType==="finish"?v.sha384.finish():v.sha384.computeHash(n.buffer)},v.hash512=function(n){if(n.operationSubType==="process"){v.sha512.process(n.buffer);return}return n.operationSubType==="finish"?v.sha512.finish():v.sha512.computeHash(n.buffer)},t.register("digest","sha-384",v.hash384),t.register("digest","sha-512",v.hash512));c["sha-384"]=v.sha384;c["sha-512"]=v.sha512;f=function(){function l(n,t){for(var r=new Array(n),i=0;i<n.length;i++)r[i]=n[i]^t[i];return r}function y(n,t){for(var i=n.slice(),r=n.length;r<t;r++)i.push(0);return i}function k(){return i.length===t?i:i.length>t?y(n.computeHash(i),t):y(i,t)}function h(i){var f,e,u;if(r)n.process(i);else{for(o=new Array(t),s=new Array(t),u=0;u<t;u++)o[u]=54,s[u]=92;r=k();f=l(r,o);p=l(r,s);e=f.concat(i);n.process(e)}return}function w(){var t=n.finish(),i=p.concat(t);return n.computeHash(i)}function b(){i=null;n=null;r=null}function c(i){switch(i.toLowerCase()){case"sha-1":if(e===undefined)throw new Error("Sha1 object not found");n=e.sha1;t=64;break;case"sha-224":n=f.sha224;t=64;break;case"sha-256":n=f.sha256;t=64;break;case"sha-384":if(u===undefined)throw new Error("Sha512 object not found");n=u.sha384;t=128;break;case"sha-512":if(u===undefined)throw new Error("Sha512 object not found");n=u.sha512;t=128;break;default:throw new Error("unsupported hash alorithm (sha-224, sha-256, sha-384, sha-512)");}}var f,u,e,n,t,i,o,s,r,p;return typeof a!="undefined"&&(f=a),typeof v!="undefined"&&(u=v),typeof d!="undefined"&&(e=d),r=null,{computeHmac:function(n,t,r){i=t;c(r);h(n);var u=w();return b(),u},process:function(t,r,u){n||(i=r,c(u));h(t)},finish:function(t,r){n||(i=t,c(r),h([]));var u=w();return b(),u}}}();typeof t!="undefined"&&(f.signHmac=function(n){var t=n.algorithm.hash.name;if(n.operationSubType==="process"){f.process(n.buffer,n.keyData,t);return}return n.operationSubType==="finish"?f.finish(n.keyData,t):f.computeHmac(n.buffer,n.keyData,t)},f.verifyHmac=function(n){var t=n.algorithm.hash.name;if(n.operationSubType==="process"){f.process(n.buffer,n.keyData,t);return}return n.operationSubType==="finish"?i.arraysEqual(f.finish(n.keyData,t),n.signature):i.arraysEqual(f.computeHmac(n.buffer,n.keyData,t),n.signature)},f.generateKey=function(n){var t=n.algorithm.length;return t||(t={"sha-256":32,"sha-384":48,"sha-512":64}[n.algorithm.hash.name]),{type:"keyGeneration",keyData:s.getBytes(t),keyHandle:{algorithm:n.algorithm,extractable:n.extractable,keyUsage:null||n.keyUsage,type:"secret"}}},f.importKey=function(n){var t=l.jwkToKey(n.keyData,n.algorithm,["k"]);return t.alg=t.alg.replace("HS","sha-"),{type:"keyImport",keyData:t.k,keyHandle:{algorithm:{name:"hmac",hash:{name:t.alg}},extractable:n.extractable||t.extractable,keyUsage:null||n.keyUsage,type:"secret"}}},f.exportKey=function(n){var t=l.keyToJwk(n.keyHandle,n.keyData);return{type:"keyExport",keyHandle:t}},t.register("importKey","hmac",f.importKey),t.register("exportKey","hmac",f.exportKey),t.register("generateKey","hmac",f.generateKey),t.register("sign","hmac",f.signHmac),t.register("verify","hmac",f.verifyHmac));g=function(){var o,n,t,r,u,f,e,s,h,c;return{aes:function(l){var d,b,a,p,v,y;o||(o=i.unpackData("AAIEBggKDA4QEhQWGBocHiAiJCYoKiwuMDI0Njg6PD5AQkRGSEpMTlBSVFZYWlxeYGJkZmhqbG5wcnR2eHp8foCChIaIioyOkJKUlpianJ6goqSmqKqsrrCytLa4ury+wMLExsjKzM7Q0tTW2Nrc3uDi5Obo6uzu8PL09vj6/P4bGR8dExEXFQsJDw0DAQcFOzk/PTMxNzUrKS8tIyEnJVtZX11TUVdVS0lPTUNBR0V7eX99c3F3dWtpb21jYWdlm5mfnZORl5WLiY+Ng4GHhbu5v72zsbe1q6mvraOhp6Xb2d/d09HX1cvJz83DwcfF+/n//fPx9/Xr6e/t4+Hn5QADBgUMDwoJGBseHRQXEhEwMzY1PD86OSgrLi0kJyIhYGNmZWxvaml4e359dHdycVBTVlVcX1pZSEtOTURHQkHAw8bFzM/Kydjb3t3U19LR8PP29fz/+vno6+7t5Ofi4aCjpqWsr6qpuLu+vbS3srGQk5aVnJ+amYiLjo2Eh4KBm5idnpeUkZKDgIWGj4yJiquora6npKGis7C1tr+8ubr7+P3+9/Tx8uPg5ebv7Onqy8jNzsfEwcLT0NXW39zZ2ltYXV5XVFFSQ0BFRk9MSUpraG1uZ2RhYnNwdXZ/fHl6Ozg9Pjc0MTIjICUmLywpKgsIDQ4HBAECExAVFh8cGRoADhwSODYkKnB+bGJIRlRa4O788tjWxMqQnoyCqKa0utvVx8nj7f/xq6W3uZOdj4E7NScpAw0fEUtFV1lzfW9hraOxv5WbiYfd08HP5ev5901DUV91e2lnPTMhLwULGRd2eGpkTkBSXAYIGhQ+MCIslpiKhK6gsrzm6Pr03tDCzEFPXVN5d2VrMT8tIwkHFRuhr72zmZeFi9HfzcPp5/X7mpSGiKKsvrDq5Pb40tzOwHp0ZmhCTF5QCgQWGDI8LiDs4vD+1NrIxpySgI6kqri2DAIQHjQ6KCZ8cmBuREpYVjc5KyUPARMdR0lbVX9xY23X2cvF7+Hz/aepu7WfkYONAA0aFzQ5LiNoZXJ/XFFGS9Ddysfk6f7zuLWir4yBlpu7tqGsj4KVmNPeycTn6v3wa2ZxfF9SRUgDDhkUNzotIG1gd3pZVENOBQgfEjE8Kya9sKeqiYSTntXYz8Lh7Pv21tvMweLv+PW+s6SpioeQnQYLHBEyPyglbmN0eVpXQE3a18DN7uP0+bK/qKWGi5yRCgcQHT4zJClib3h1VltMQWFse3ZVWE9CCQQTHj0wJyqxvKumhYifktnUw87t4Pf6t7qtoIOOmZTf0sXI6+bx/GdqfXBTXklEDwIVGDs2ISwMARYbODUiL2RpfnNQXUpH3NHGy+jl8v+0ua6jgI2alwALFh0sJzoxWFNORXR/Ymmwu6atnJeKgejj/vXEz9LZe3BtZldcQUojKDU+DwQZEsvA3dbn7PH6k5iFjr+0qaL2/eDr2tHMx66luLOCiZSfRk1QW2phfHceFQgDMjkkL42Gm5Chqre81d7DyPny7+Q9NisgERoHDGVuc3hJQl9U9/zh6tvQzcavpLmyg4iVnkdMUVprYH12HxQJAjM4JS6Mh5qRoKu2vdTfwsn48+7lPDcqIRAbBg1kb3J5SENeVQEKFxwtJjswWVJPRHV+Y2ixuqesnZaLgOni//TFztPYenFsZ1ZdQEsiKTQ/DgUYE8rB3Nfm7fD7kpmEj761qKMACRIbJC02P0hBWlNsZX53kJmCi7S9pq/Y0crD/PXu5zsyKSAfFg0Ec3phaFdeRUyrormwj4adlOPq8fjHztXcdn9kbVJbQEk+NywlGhMIAebv9P3Cy9DZrqe8tYqDmJFNRF9WaWB7cgUMFx4hKDM63dTPxvnw6+KVnIeOsbijquzl/vfIwdrTpK22v4CJkpt8dW5nWFFKQzQ9Ji8QGQIL197FzPP64eiflo2Eu7KpoEdOVVxjanF4DwYdFCsiOTCak4iBvrespdLbwMn2/+TtCgMYES4nPDVCS1BZZm90faGos7qFjJee6eD78s3E39YxOCMqFRwHDnlwa2JdVE9GY3x3e/Jrb8UwAWcr/terdsqCyX36WUfwrdSir5ykcsC3/ZMmNj/3zDSl5fFx2DEVBMcjwxiWBZoHEoDi6yeydQmDLBobblqgUjvWsynjL4RT0QDtIPyxW2rLvjlKTFjP0O+q+0NNM4VF+QJ/UDyfqFGjQI+SnTj1vLbaIRD/89LNDBPsX5dEF8Snfj1kXRlzYIFP3CIqkIhG7rgU3l4L2+AyOgpJBiRcwtOsYpGV5HnnyDdtjdVOqWxW9Opleq4IunglLhymtMbo3XQfS72LinA+tWZIA/YOYTVXuYbBHZ7h+JgRadmOlJseh+nOVSjfjKGJDb/mQmhBmS0PsFS7FlIJatUwNqU4v0CjnoHz1/t84zmCmy//hzSOQ0TE3unLVHuUMqbCIz3uTJULQvrDTgguoWYo2SSydluiSW2L0SVy+PZkhmiYFtSkXMxdZbaSbHBIUP3tudpeFUZXp42dhJDYqwCMvNMK9+RYBbizRQbQLB6Pyj8PAsGvvQMBE4prOpERQU9n3OqX8s/O8LTmc5asdCLnrTWF4vk36Bx1325H8RpxHSnFiW+3Yg6qGL4b/FY+S8bSeSCa28D+eM1a9B/dqDOIB8cxsRIQWSeA7F9gUX+pGbVKDS3lep+TyZzvoOA7Ta4q9bDI67s8g1OZYRcrBH66d9Ym4WkUY1UhDH2NAQIECBAgQIAbNmzYq02aL168Y8aXNWrUs33678WROXLk071hwp8lSpQzZsyDHTp06MuNAQIECBAgQIAbNmzYq02aL168Y8aXNWrUs33678WROXLk071hwp8lSpQzZsyDHTp06MuNAQIECBAgQIAbNmzYq02aL168Y8aXNWrUs33678WROXLk071hwp8lSpQzZsyDHTp06MuNAQIECBAgQIAbNmzYq02aL168Y8aXNWrUs33678WROXLk071hwp8lSpQzZsyDHTp06MuNAQIECBAgQIAbNmzYq02aL168Y8aXNWrUs33678WROXLk071hwp8lSpQzZsyDHTp06MuN",256,!1),n=o[0],t=o[1],r=o[2],u=o[3],f=o[4],e=o[5],s=o[6],h=o[7],c=o[8]);d=128;p=4;switch(l.length*8){case 128:b=128;a=4;v=10;break;case 192:b=192;a=6;v=12;break;case 256:b=256;a=8;v=14;break;default:throw new Error("Unsupported keyLength");}var g=function(n){var t=n[1];n[1]=n[5];n[5]=n[9];n[9]=n[13];n[13]=t;t=n[2];n[2]=n[10];n[10]=t;t=n[6];n[6]=n[14];n[14]=t;t=n[15];n[15]=n[11];n[11]=n[7];n[7]=n[3];n[3]=t},nt=function(n){var t=n[13];n[13]=n[9];n[9]=n[5];n[5]=n[1];n[1]=t;t=n[10];n[10]=n[2];n[2]=t;t=n[14];n[14]=n[6];n[6]=t;t=n[3];n[3]=n[7];n[7]=n[11];n[11]=n[15];n[15]=t},ut=function(i){var r=i[0],u=i[1],f=i[2],e=i[3],o=i[4],s=i[5],h=i[6],c=i[7],l=i[8],a=i[9],v=i[10],y=i[11],p=i[12],w=i[13],b=i[14],k=i[15];i[0]=n[r]^t[u]^f^e;i[1]=r^n[u]^t[f]^e;i[2]=r^u^n[f]^t[e];i[3]=t[r]^u^f^n[e];i[4]=n[o]^t[s]^h^c;i[5]=o^n[s]^t[h]^c;i[6]=o^s^n[h]^t[c];i[7]=t[o]^s^h^n[c];i[8]=n[l]^t[a]^v^y;i[9]=l^n[a]^t[v]^y;i[10]=l^a^n[v]^t[y];i[11]=t[l]^a^v^n[y];i[12]=n[p]^t[w]^b^k;i[13]=p^n[w]^t[b]^k;i[14]=p^w^n[b]^t[k];i[15]=t[p]^w^b^n[k]},ft=function(n){var t=n[0],i=n[1],o=n[2],s=n[3],h=n[4],c=n[5],l=n[6],a=n[7],v=n[8],y=n[9],p=n[10],w=n[11],b=n[12],k=n[13],d=n[14],g=n[15];n[0]=r[t]^f[i]^u[o]^e[s];n[1]=e[t]^r[i]^f[o]^u[s];n[2]=u[t]^e[i]^r[o]^f[s];n[3]=f[t]^u[i]^e[o]^r[s];n[4]=r[h]^f[c]^u[l]^e[a];n[5]=e[h]^r[c]^f[l]^u[a];n[6]=u[h]^e[c]^r[l]^f[a];n[7]=f[h]^u[c]^e[l]^r[a];n[8]=r[v]^f[y]^u[p]^e[w];n[9]=e[v]^r[y]^f[p]^u[w];n[10]=u[v]^e[y]^r[p]^f[w];n[11]=f[v]^u[y]^e[p]^r[w];n[12]=r[b]^f[k]^u[d]^e[g];n[13]=e[b]^r[k]^f[d]^u[g];n[14]=u[b]^e[k]^r[d]^f[g];n[15]=f[b]^u[k]^e[d]^r[g]},tt=function(n,t){return[n[0]^t[0],n[1]^t[1],n[2]^t[2],n[3]^t[3]]},w=function(n,t,i){for(var r=0;r<n.length;r+=1)n[r]^=t[r+i]},et=function(n){var t=n[0];n[0]=n[1];n[1]=n[2];n[2]=n[3];n[3]=t},k=function(n){for(var t=0;t<n.length;t+=1)n[t]=s[n[t]]},it=function(n){for(var t=0;t<n.length;t+=1)n[t]=h[n[t]]},rt=function(n,t){return[n[4*t],n[4*t+1],n[4*t+2],n[4*t+3]]},ot=function(n,t,i,r){n[4*i]=t[4*r];n[4*i+1]=t[4*r+1];n[4*i+2]=t[4*r+2];n[4*i+3]=t[4*r+3]},st=function(n){for(var i,r=[],t=0,u,f,e;t<4*a;)r.push(n[t++]);for(t=a;t<p*(v+1);)i=rt(r,t-1),t%a==0?(u=t/a,f=[c[u],0,0,0],et(i),k(i),i=tt(i,f)):a>6&&t%a==4&&k(i),e=tt(rt(r,t-a),i),ot(r,e,t,0),t+=1;return r};return y=st(l),{encrypt:function(n){var t=n,i;for(w(t,y,0),i=1;i<=v-1;i+=1)k(t),g(t),ut(t),w(t,y,4*i*p);return k(t),g(t),w(t,y,4*v*p),t},decrypt:function(n){var t=n,i;for(w(t,y,4*v*p),i=v-1;i>=1;i-=1)nt(t),it(t),w(t,y,4*i*p),ft(t);return nt(t),it(t),w(t,y,0),t},clear:function(){},keyLength:b,blockSize:d}}}}();st=st||{};st.pkcsv7=function(n){function t(t){var o=t.length-1>=0?t.length-1:0,i=t[o],f=i.length,s=f===n,r,u,e;if(s){for(r=[],u=0;u<n;u+=1)r.push(n);t.push(r)}else for(e=n-f&255;i.length!==n;)i.push(e)}function i(t){var i=!0,u,f,r,e,o,s;for(t.length%n!=0&&(i=!1),u=t.slice(-n),f=u[u.length-1],r=0;r<n;r++)e=n-r<=f,o=u[r]===f,i=(e?o:!0)&&i;return s=i?f:0,t.length-=s,i}return{pad:t,unpad:i}};p=function(n){function s(n){var f=[],r,i;for(t=t.concat(n),r=Math.floor(t.length/u),i=0;i<r;i++)f.push(t.slice(i*u,(i+1)*u));return t=t.slice(r*u),f}function h(t){for(var u=[],e,r=0;r<t.length;r++)e=i.xorVectors(f,t[r]),u.push(n.encrypt(e)),f=u[r];return u}function l(t){for(var u=[],e,o,r=0;r<t.length;r+=1)e=t[r].slice(0,t[r].length),o=n.decrypt(e),u.push(i.xorVectors(f,o)),f=t[r];return u}function c(){t=[];r=[];f=null}var u=n.blockSize/8,o=st.pkcsv7(u),e=function(n){for(var u=[],i,r,t=0;t<n.length;t+=1)for(r=n[t],i=0;i<r.length;i+=1)u.push(r[i]);return u},t=[],r=[],f;return{init:function(n){if(n.length!==u)throw new Error("Invalid iv size");f=n.slice()},encrypt:function(n){return this.processEncrypt(n),this.finishEncrypt()},processEncrypt:function(n){var t=h(s(n));r=r.concat(e(t));return},finishEncrypt:function(){var n=t.length===1?[[t[0]]]:[t],i;return o.pad(n),i=r.concat(e(h(n))),c(),i},decrypt:function(n){return this.processDecrypt(n),this.finishDecrypt()},processDecrypt:function(n){var t=l(s(n));r=r.concat(e(t));return},finishDecrypt:function(){var n=r,t=o.unpad(n);return c(),n}}};e=null;typeof t!="undefined"&&(p.workerEncrypt=function(n){var t;if(e||(e=p(g.aes(n.keyData)),e.init(n.algorithm.iv)),n.operationSubType==="process"){e.processEncrypt(n.buffer);return}return n.operationSubType==="finish"?(t=e.finishEncrypt(),e=null,t):(t=e.encrypt(n.buffer),e=null,t)},p.workerDecrypt=function(n){var t;if(e||(e=p(g.aes(n.keyData)),e.init(n.algorithm.iv)),n.operationSubType==="process"){e.processDecrypt(n.buffer);return}return n.operationSubType==="finish"?(t=e.finishDecrypt(),e=null,t):(t=e.decrypt(n.buffer),e=null,t)},p.generateKey=function(n){if(n.algorithm.length%8!=0)throw new Error;return{type:"keyGeneration",keyData:s.getBytes(Math.floor(n.algorithm.length/8)),keyHandle:{algorithm:n.algorithm,extractable:n.extractable,keyUsage:null||n.keyUsage,type:"secret"}}},p.importKey=function(n){var t=l.jwkToKey(n.keyData,n.algorithm,["k"]);return{type:"keyImport",keyData:t.k,keyHandle:{algorithm:n.algorithm,extractable:n.extractable||t.extractable,keyUsage:null||n.keyUsage,type:"secret"}}},p.exportKey=function(n){var t=l.keyToJwk(n.keyHandle,n.keyData);return{type:"keyExport",keyHandle:t}},t.register("importKey","aes-cbc",p.importKey),t.register("exportKey","aes-cbc",p.exportKey),t.register("generateKey","aes-cbc",p.generateKey),t.register("encrypt","aes-cbc",p.workerEncrypt),t.register("decrypt","aes-cbc",p.workerDecrypt));y=function(n){function a(n,t){for(var u=Math.floor(t.length/16),f,i=0;i<u;i++)f=t.slice(i*16,i*16+16),p=tt(r.xorVectors(p,f),n);return k=t.slice(u*16),p}function w(){var n=16*Math.ceil(e/16)-e,t=d(v.length*8),i=d(e*8),u=k.concat(r.getVector(n)).concat(t).concat(i);return a(l,u)}function tt(n,t){for(var u=r.getVector(16),i=t.slice(),o=[225,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e,f=0;f<128;f++)e=it(n,f),e===1&&(u=r.xorVectors(u,i)),i[15]&1?(g(i),i=r.xorVectors(i,o)):g(i);return u}function g(n){for(var t=n.length-1;t>0;t--)n[t]=(n[t-1]&1)<<7|n[t]>>>1;return n[0]=n[0]>>>1,n}function it(n,t){var i=Math.floor(t/8);return n[i]>>7-t%8&1}function nt(n){for(var i=256,t=1;t<=4;t++)i=(i>>>8)+n[n.length-t],n[n.length-t]=i&255;return n}function o(t,i){var h=Math.ceil(i.length/16),o,e=[],u,s;for(f!==t&&(f=t.slice()),u=0;u<h;u++)o=i.slice(u*16,u*16+16),s=n.encrypt(f.slice()),e=e.concat(r.xorVectors(o,s)),f=nt(f);return e}function d(n){return[0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,n&255]}function rt(n){var t=16*Math.ceil(v.length/16)-v.length;return n.concat(r.getVector(t))}function b(){e=0;t=[];u=[];p=r.getVector(16);k=[];f=s=v=null}function ut(n,t,i){if(v=t||[],h=isNaN(i)?128:i,h%8!=0)throw new Error("DataError");if(s=n,s.length===12)c=s.concat([0,0,0,1]);else{var u=16*Math.ceil(s.length/16)-s.length;c=a(l,s.concat(r.getVector(u+8)).concat(d(s.length*8)));p=r.getVector(16)}y=nt(c.slice());a(l,rt(v))}function ft(n){var t,i,r;return e=n.length,t=o(y,n),a(l,t),i=w(),r=o(c,i).slice(0,h/8),b(),t.slice().concat(r)}function et(n,t){var i,u,f;return e=n.length,i=o(y,n),a(l,n),u=w(),f=o(c,u).slice(0,h/8),b(),r.arraysEqual(f,t)?i:null}function ot(n){var i,r;t=t.concat(n);i=t.slice(0,Math.floor(t.length/16)*16);e+=i.length;t=t.slice(i.length);r=o(f||y,i);u=u.concat(r);a(l,r)}function st(n){var i,r;t=t.concat(n);i=t.slice(0,Math.floor((t.length-h/8)/16)*16);e+=i.length;t=t.slice(i.length);r=o(f||y,i);u=u.concat(r);a(l,i)}function ht(){var n=o(f,t);u=u.concat(n);e+=t.length;var i=w(),r=o(c,i).slice(0,h/8),s=u.slice().concat(r);return b(),s}function ct(){var n=Math.floor(h/8),s=t.slice(-n),i;t=t.slice(0,t.length-n);i=o(f,t);u=u.concat(i);e+=t.length;var l=w(),a=o(c,l).slice(0,h/8),v=u.slice();if(b(),r.arraysEqual(a,s))return v;throw new Error("OperationError");}var r=i,t=[],s,v,h,c,y,l=n.encrypt(r.getVector(16)),p=r.getVector(16),k=[],u=[],f,e=0;return{init:ut,encrypt:ft,decrypt:et,processEncrypt:ot,processDecrypt:st,finishEncrypt:ht,finishDecrypt:ct}};typeof t!="undefined"&&(y.encrypt=function(n){var t;if(o||(o=y(g.aes(n.keyData)),o.init(n.algorithm.iv,n.algorithm.additionalData,n.algorithm.tagLength)),n.operationSubType==="process"){o.processEncrypt(n.buffer);return}return n.operationSubType==="finish"?(t=o.finishEncrypt(),o=null,t):(t=o.encrypt(n.buffer),o=null,t)},y.decrypt=function(n){var t;if(o||(o=y(g.aes(n.keyData)),o.init(n.algorithm.iv,n.algorithm.additionalData,n.algorithm.tagLength)),n.operationSubType==="process"){o.processDecrypt(n.buffer);return}if(n.operationSubType==="finish")return t=o.finishDecrypt(),o=null,t;var i=Math.floor(n.algorithm.tagLength/8),r=n.buffer.slice(0,n.buffer.length-i),u=n.buffer.slice(-i);return t=o.decrypt(r,u),o=null,t},y.generateKey=function(n){if(n.algorithm.length%8!=0)throw new Error;return{type:"keyGeneration",keyData:s.getBytes(Math.floor(n.algorithm.length/8)),keyHandle:{algorithm:n.algorithm,extractable:n.extractable,keyUsage:null||n.keyUsage,type:"secret"}}},y.importKey=function(n){var t=l.jwkToKey(n.keyData,n.algorithm,["k"]);return{type:"keyImport",keyData:t.k,keyHandle:{algorithm:n.algorithm,extractable:n.extractable||t.extractable,keyUsage:null||n.keyUsage,type:"secret"}}},y.exportKey=function(n){var t=l.keyToJwk(n.keyHandle,n.keyData);return{type:"keyExport",keyHandle:t}},t.register("importKey","aes-gcm",y.importKey),t.register("exportKey","aes-gcm",y.exportKey),t.register("generateKey","aes-gcm",y.generateKey),t.register("encrypt","aes-gcm",y.encrypt),t.register("decrypt","aes-gcm",y.decrypt));s=new ct;var ti=function(t){function r(t){var i=n.digitsToBytes(t);return f.padFront(i,0,s),i}function u(t,i,r){var f=n.bytesToDigits(i),u=n.IntegerGroup(r),e=u.createElementFromBytes(t),o=u.modexp(e,f);return o.m_digits}function h(n){var i=u(n,t.d,t.n);return r(i)}function c(i){var l=t.p,a=t.q,v=t.dp,y=t.dq,p=t.qi,f=n.bytesToDigits(l),o=n.bytesToDigits(a),u=new Array(f.length+o.length),s=new Array(f.length+1),h=new Array(o.length+1),e=n.bytesToDigits(i),c;return n.reduce(e,f,u),n.modExp(u,n.bytesToDigits(v),f,s),n.reduce(e,o,u),n.modExp(u,n.bytesToDigits(y),o,h),c=n.subtract(s,h,u),c!==0&&n.subtract(h,s,u),n.modMul(u,n.bytesToDigits(p),f,e),c!==0&&n.subtract(f,e,e),n.multiply(e,o,u),n.add(h,u,s),r(s)}var f=i,e=t.hasOwnProperty("n")&&t.hasOwnProperty("d"),o=t.hasOwnProperty("p")&&t.hasOwnProperty("q"),s=t.n.length;return{encrypt:function(n){return r(u(n,t.e,t.n))},decrypt:function(n){if(o)return c(n);if(e)return h(n);throw new Error("missing private key");}}},et={mgf1:function(n,t,i){for(var u=[],f,e,o=i.hashLen/8,r=0;r<=Math.floor(t/o);r+=1)f=[r>>>24&255,r>>>16&255,r>>>8&255,r&255],e=i.computeHash(n.concat(f)),u=u.concat(e);return u.slice(0,t)},checkMessageVsMaxHash:function(n,t){if(n.length>(t.maxMessageSize||4294967295))throw new Error("message too long");return}},w=w||{};return w.oaep=function(n,t){function e(n,i){var e,c,l,a,o,v,s,y,p,h;if(n.length>u-t.hashLen/4-2)throw new Error("Message too long.");return i||(i=[]),e=t.computeHash(i),c=u-n.length-2*e.length-2,l=r.getVector(c),a=e.concat(l,[1],n),o=f.getBytes(e.length),v=et.mgf1(o,u-e.length-1,t),s=r.xorVectors(a,v),y=et.mgf1(s,e.length,t),p=r.xorVectors(o,y),h=[0].concat(p).concat(s),n=h.slice(),h}function o(n,i){var f,s,o,h,c,l,e,a,v;if(i||(i=[]),f=t.computeHash(i),n[0]!==0)throw new Error("Encryption Error");if(s=n.slice(1,f.length+1),o=n.slice(f.length+1),h=et.mgf1(o,f.length,t),c=r.xorVectors(s,h),l=et.mgf1(c,u-f.length-1,t),e=r.xorVectors(o,l),a=e.slice(0,f.length),!r.arraysEqual(f,a))throw new Error("Encryption Error");return e=e.slice(f.length),v=e.indexOf(1),e.slice(v+1)}var r=i,f=s,u=n.n.length;if(t===null)throw new Error("must supply hashFunction");return{pad:function(n,t){return e(n,t)},unpad:function(n,t){return o(n,t)}}},w=w||{},w.pkcs1Encrypt=function(n){function r(n){var r;if(n.length>t-11)throw new Error("message too long");return r=i.getNonZeroBytes(t-n.length-3),[0,2].concat(r,[0],n)}function u(n){for(var t=1;t<n.length;t+=1)if(n[t]===0)break;return n.slice(t+1)}var i=s,t=n.n.length;return{pad:function(n){return r(n)},unpad:function(n){return u(n)}}},w.pkcs1Sign=function(n,t){function f(n){var i,e,f;if(e=t.computeHash(n.slice()),i=t.der.concat(e),f=i.length,u<f+11)throw new Error("intended encoded message length too short");return[0,1].concat(r.getVector(u-f-3,255),[0],i)}var r=i,u=n.n.length;return{sign:function(n){return f(n)},verify:function(n,t){var i=f(t);return r.arraysEqual(n,i)}}},w=w||{},w.pss=function(n,t){function f(i,f,e){var l=n.n.length*8-1,o=Math.ceil(l/8),c=t.computeHash(i),h;if(f=e?e.length:f||c.length,o<c.length+f+2)throw new Error("encoding error");e=e||u.getBytes(f);var y=[0,0,0,0,0,0,0,0].concat(c,e),s=t.computeHash(y),p=r.getVector(o-e.length-s.length-2),w=p.concat([1],e),b=et.mgf1(s,o-s.length-1,t),a=r.xorVectors(w,b),v=0;for(h=0;h<8-(8*o-l);h++)v+=1<<h;return a[0]&=v,a.concat(s,[188])}function e(i,u,f){var l=n.n.length*8-1,o=Math.ceil(l/8),a=t.computeHash(u),e=a.length,h;if(f=f||e,o<e+f+2)return!1;var c=i.slice(0,o-e-1),v=i.slice(c.length,c.length+e),y=et.mgf1(v,o-e-1,t),s=r.xorVectors(c,y);for(s[0]&=255>>>8-(8*o-l),h=0;h<o-e-f-2;h++)if(s[h]!==0)return!1;if(s[o-e-f-2]!==1)return!1;var p=s.slice(-f),w=[0,0,0,0,0,0,0,0].concat(a,p),b=t.computeHash(w);return r.arraysEqual(b,v)}var r=i,u=s;return{sign:function(n,t,i){return f(n,t,i)},verify:function(n,t,i){return e(n,t,i)}}},r=function(n,t,i){function o(){if(!i||!i.computeHash)throw new Error("missing hash function");}var e=ti(n),u,f,r;if(!t)throw new Error("padding mode");u=null;f=null;switch(t){case"rsaes-pkcs1-v1_5":r=w.pkcs1Encrypt(n);break;case"rsassa-pkcs1-v1_5":o();r=w.pkcs1Sign(n,i);break;case"rsa-oaep":o();r=w.oaep(n,i);break;case"rsa-pss":o();r=w.pss(n,i);break;case"raw":r={pad:function(n){return n},unpad:function(n){return n}};break;default:throw new Error("invalid mode");}return r&&(u=r.pad||r.sign,f=r.unpad||r.verify),{encrypt:function(n,t){var i;return i=u!==null?u(n,t):n.slice(),e.encrypt(i)},decrypt:function(n,t){var i=e.decrypt(n);return f!==null?f(i,t):i.slice(0)},signData:function(n,t,i){return e.decrypt(u(n,t,i))},verifySignature:function(n,t,i){var r=e.encrypt(n);return f(r,t,i)},mode:t}},typeof t!="undefined"&&(r.sign=function(n){var t,i=n.algorithm.hash.name,u=c[i.toLowerCase()],f=n.algorithm.saltLength,e=n.algorithm.salt;return t=r(n.keyData,n.algorithm.name,u),t.signData(n.buffer,f,e)},r.verify=function(n){var i=n.algorithm.hash.name,u=c[i.toLowerCase()],t,f=n.algorithm.saltLength;return t=r(n.keyData,n.algorithm.name,u),t.verifySignature(n.signature,n.buffer,f)},r.workerEncrypt=function(n){var i,t,f,u;switch(n.algorithm.name){case"rsaes-pkcs1-v1_5":t=r(n.keyData,n.algorithm.name);i=t.encrypt(n.buffer);break;case"rsa-oaep":if(u=n.algorithm.hash.name,!u)throw new Error("unsupported hash algorithm");f=c[u.toLowerCase()];t=r(n.keyData,n.algorithm.name,f);i=t.encrypt(n.buffer);break;default:throw new Error("unsupported algorithm");}return i},r.workerDecrypt=function(n){var i,t,f,u;switch(n.algorithm.name){case"rsaes-pkcs1-v1_5":t=r(n.keyData,n.algorithm.name);i=t.decrypt(n.buffer);break;case"rsa-oaep":if(u=n.algorithm.hash.name,!u)throw new Error("unsupported hash algorithm");f=c[u.toLowerCase()];t=r(n.keyData,n.algorithm.name,f);i=t.decrypt(n.buffer);break;default:throw new Error("unsupported algorithm");}return i},r.importKey=function(n){var t=l.jwkToKey(n.keyData,n.algorithm,["n","e","d","q","p","dq","dp","qi"]);return{type:"keyImport",keyData:t,keyHandle:{algorithm:n.algorithm,extractable:n.extractable||t.extractable,keyUsage:null||n.keyUsage,type:t.d||t.dq?"private":"public"}}},r.exportKey=function(n){var t=l.keyToJwk(n.keyHandle,n.keyData);return{type:"keyExport",keyHandle:t}},t.register("sign","rsassa-pkcs1-v1_5",r.sign),t.register("sign","rsa-pss",r.sign),t.register("verify","rsassa-pkcs1-v1_5",r.verify),t.register("verify","rsa-pss",r.verify),t.register("encrypt","rsa-oaep",r.workerEncrypt),t.register("encrypt","rsaes-pkcs1-v1_5",r.workerEncrypt),t.register("decrypt","rsa-oaep",r.workerDecrypt),t.register("decrypt","rsaes-pkcs1-v1_5",r.workerDecrypt),t.register("importKey","rsa-oaep",r.importKey),t.register("importKey","rsaes-pkcs1-v1_5",r.importKey),t.register("importKey","rsassa-pkcs1-v1_5",r.importKey),t.register("importKey","rsa-pss",r.importKey),t.register("exportKey","rsa-oaep",r.exportKey),t.register("exportKey","rsaes-pkcs1-v1_5",r.exportKey),t.register("exportKey","rsassa-pkcs1-v1_5",r.exportKey),t.register("exportKey","rsa-pss",r.exportKey)),it=function(n){function r(i,r,u){for(var o,s,h=Math.ceil(u/(n.hashLen/8)),c=1,l=i.concat(r),f=[],e=0;e<h;e++)o=t.int32ToBytes(c++).concat(l),s=n.computeHash(o),f=f.concat(s);return f.slice(0,u)}var t=i;return{deriveKey:r}},rt=null,typeof t!="undefined"&&(it.deriveKey=function(n){var i=n.algorithm.hash.name,r=c[i.toLowerCase()];rt=it(r);var t=n.algorithm,u=t.algorithmId.concat(t.partyUInfo,t.partyVInfo,t.publicInfo||[],t.privateInfo||[]),f=rt.deriveKey(n.keyData,u,n.derivedKeyType.length);return rt=null,{type:"keyDerive",keyData:f,keyHandle:{algorithm:n.derivedKeyType,extractable:n.extractable,keyUsage:null||n.keyUsage,type:"secret"}}},it.deriveBits=function(n){var i=n.algorithm.hash.name,r=c[i.toLowerCase()];rt=it(r);var t=n.algorithm,u=t.algorithmId.concat(t.partyUInfo,t.partyVInfo,t.publicInfo||[],t.privateInfo||[]),f=rt.deriveKey(n.keyData,u,n.length);return rt=null,f},t.register("deriveKey","concat",it.deriveKey),t.register("deriveBits","concat",it.deriveBits)),h=function(t){function e(){var e=[],o=s.getBytes(t.order.length*n.DIGIT_NUM_BYTES),f;return n.reduce(n.bytesToDigits(o),r.order,e),r.generator.isInMontgomeryForm||i.convertToMontgomeryForm(r.generator),f=r.allocatePointStorage(),i.convertToJacobianForm(f),i.convertToMontgomeryForm(f),i.scalarMultiply(e,r.generator,f),i.convertToAffineForm(f),i.convertToStandardForm(f),{privateKey:{x:u(f.x),y:u(f.y),d:u(e)},publicKey:{x:u(f.x),y:u(f.y)}}}function o(t,u,e){var s=new b.EllipticCurvePointFp(r,!1,f(u.x),f(u.y),null,!1),o,h;if(s.isInMontgomeryForm||i.convertToMontgomeryForm(s),s.isAffine||i.convertToAffineForm(s),o=r.allocatePointStorage(),i.convertToJacobianForm(o),i.convertToMontgomeryForm(o),i.scalarMultiply(f(t.d),s,o),i.convertToAffineForm(o),i.convertToStandardForm(o),h=n.digitsToBytes(o.x),e&&h.length<e)throw new Error("DataError");return e?h.slice(0,e):h}function h(n){r.generator.isInMontgomeryForm||i.convertToMontgomeryForm(r.generator);var t=r.allocatePointStorage();return i.convertToJacobianForm(t),i.convertToMontgomeryForm(t),i.scalarMultiply(f(n),r.generator,t),{x:u(t.x),y:u(t.y)}}var f=n.bytesToDigits,u=n.digitsToBytes,r=t,i=new b.EllipticCurveOperatorFp(t);return{generateKey:e,deriveBits:o,computePublicKey:h}},ut=null,typeof t!="undefined"&&(h.curves={"P-256":b.createP256,"P-384":b.createP384,"P-521":b.createP521},h.deriveBits=function(n){var t=h.curves[n.algorithm.namedCurve.toUpperCase()](),i=n.keyData,r=n.additionalKeyData;return ut=h(t),ut.deriveBits(i,r,n.length)},h.generateKey=function(n){var i=h.curves[n.algorithm.namedCurve.toUpperCase()](),t;return ut=h(i),t=ut.generateKey(),{type:"keyPairGeneration",keyPair:{publicKey:{keyData:t.publicKey,keyHandle:{algorithm:n.algorithm,extractable:n.extractable,keyUsage:null||n.keyUsage,type:"public"}},privateKey:{keyData:t.privateKey,keyHandle:{algorithm:n.algorithm,extractable:n.extractable,keyUsage:null||n.keyUsage,type:"private"}}}}},h.importKey=function(n){var t=l.jwkToKey(n.keyData,n.algorithm,["x","y","d","crv"]),r,i;return!t.d||t.x&&t.y||(r=h.curves[n.algorithm.namedCurve](),ut=h(r),i=ut.computePublicKey(t.d),t.x=i.x,t.y=i.y),{type:"keyImport",keyData:t,keyHandle:{algorithm:n.algorithm,extractable:n.extractable||t.extractable,keyUsage:null||n.keyUsage,type:t.d?"private":"public"}}},h.exportKey=function(n){var t=l.keyToJwk(n.keyHandle,n.keyData);return{type:"keyExport",keyHandle:t}},t.register("importKey","ecdh",h.importKey),t.register("exportKey","ecdh",h.exportKey),t.register("generateKey","ecdh",h.generateKey),t.register("deriveBits","ecdh",h.deriveBits)),u=function(t){function c(n){return e(r(n))}function e(n){t.generator.isInMontgomeryForm||i.convertToMontgomeryForm(t.generator);var r=t.allocatePointStorage();return i.convertToJacobianForm(r),i.convertToMontgomeryForm(r),i.scalarMultiply(n,t.generator,r),i.convertToAffineForm(r),i.convertToStandardForm(r),{publicKey:r,privateKey:n}}function o(){var r=[],u=s.getBytes(t.order.length*n.DIGIT_NUM_BYTES);return n.reduce(n.bytesToDigits(u),t.order,r),t.generator.isInMontgomeryForm||i.convertToMontgomeryForm(t.generator),e(r)}function h(i){i.length>u&&(i.length=u);var f=r(i);return n.reduce(f,t.order,f),f}function l(i,e,s){if(!s)do s=o();while(n.isZero(s.publicKey.x)||n.compareDigits(t.order,s.publicKey.x)===0);if(!s.publicKey)throw new Error("ephemeralKey.publicKey missing");if(!s.privateKey)throw new Error("ephemeralKey.privateKey missing");var l=s.publicKey.x,v=s.privateKey,y=r(i.d),p=h(e.slice()),c=[],a=[];return n.modMul(l,y,t.order,c),n.add(c,p,c),n.reduce(c,t.order,c),n.modInv(v,t.order,a),n.modMul(c,a,t.order,c),f(l,!0,u).concat(f(c,!0,u))}function a(u,f,e){var l=Math.floor(f.length/2),a=r(f.slice(0,l)),c=r(f.slice(l)),w=h(e.slice()),v=[],y=[],p=new b.EllipticCurvePointFp(t,!1,r(u.x),r(u.y),null,!1),o,s;return(n.modInv(c,t.order,c),n.modMul(w,c,t.order,v),n.modMul(a,c,t.order,y),o=t.allocatePointStorage(),i.convertToJacobianForm(o),i.convertToMontgomeryForm(o),t.generator.isInMontgomeryForm||i.convertToMontgomeryForm(t.generator),t.generator.isAffine||i.convertToStandardForm(t.generator),i.scalarMultiply(v,t.generator,o),s=t.allocatePointStorage(),i.convertToJacobianForm(s),i.convertToMontgomeryForm(s),i.convertToMontgomeryForm(p),i.scalarMultiply(y,p,s),i.convertToAffineForm(s),i.mixedAdd(o,s,o),i.convertToAffineForm(o),i.convertToStandardForm(o),o.isInfinity)?!1:n.compareDigits(o.x,a)===0?!0:!1}var r=n.bytesToDigits,f=n.digitsToBytes,i=new b.EllipticCurveOperatorFp(t),u=f(t.order).length;return{createKey:c,generateKey:o,sign:l,verify:a}},typeof t!="undefined"&&(u.curves={"p-256":b.createP256,"p-384":b.createP384},u.sign=function(n){var t=n.algorithm.hash.name,i=u.curves[n.algorithm.namedCurve](),r=c[t.toLowerCase()],f=r.computeHash(n.buffer),e=u(i);return e.sign(n.keyData,f)},u.verify=function(n){var t=n.algorithm.hash.name,i=u.curves[n.algorithm.namedCurve](),r=c[t.toLowerCase()],f=r.computeHash(n.buffer),e=u(i);return e.verify(n.keyData,n.signature,f)},u.generateKey=function(t){function e(n){return i.padFront(n,0,Math.ceil(n.length/8)*8)}var h=u.curves[t.algorithm.namedCurve](),c=u(h),r=c.generateKey(),f=n.digitsToBytes,o=e(f(r.publicKey.x)),s=e(f(r.publicKey.y)),l=e(f(r.privateKey));return{type:"keyPairGeneration",keyPair:{publicKey:{keyData:{x:o,y:s},keyHandle:{algorithm:t.algorithm,extractable:t.extractable,keyUsage:null||t.keyUsage,type:"public"}},privateKey:{keyData:{x:o,y:s,d:l},keyHandle:{algorithm:t.algorithm,extractable:t.extractable,keyUsage:null||t.keyUsage,type:"private"}}}}},u.importKey=function(n){var t=l.jwkToKey(n.keyData,n.algorithm,["x","y","d","crv"]);if(t.d&&(!t.x||!t.y)){var r=u.curves[n.algorithm.namedCurve](),f=u(r),i=f.computePublicKey(t.d);t.x=i.x;t.y=i.y}return{type:"keyImport",keyData:t,keyHandle:{algorithm:n.algorithm,extractable:n.extractable||t.extractable,keyUsage:null||n.keyUsage,type:t.d?"private":"public"}}},u.exportKey=function(n){var t=l.keyToJwk(n.keyHandle,n.keyData);return{type:"keyExport",keyHandle:t}},t.register("sign","ecdsa",u.sign),t.register("verify","ecdsa",u.verify),t.register("generateKey","ecdsa",u.generateKey),t.register("importKey","ecdsa",u.importKey),t.register("exportKey","ecdsa",u.exportKey)),ot||(pt=function(){function h(){function t(t){try{if(n=yt.jsCryptoRunner({data:t}),!t.operationSubType||t.operationSubType!=="process")this.onmessage({data:n})}catch(i){this.onerror({data:i.description,type:"error"})}}var n;return{postMessage:t,onmessage:null,onerror:null,terminate:function(){}}}function c(n){function u(){}function f(){}function e(n){i=n;this.result&&i({target:this})}function o(n){r=n}function s(){return i}function h(){return r}function c(t){if(t.type==="error"){if(this.onerror)this.onerror(t);return}if(t.type!=="process"){if(this.result=n(t.data),this.oncomplete)this.oncomplete({target:this});return}}var i=null,r=null,t;return t={dispatchEvent:c,addEventListener:u,removeEventListener:f,result:null},k(t,"oncomplete",null,s,e),k(t,"onerror",null,h,o),t}function p(){function t(t){switch(t.type){case"keyGeneration":case"keyImport":case"keyDerive":return n.add(t.keyHandle,t.keyData),t.keyHandle;case"keyExport":return l(t.keyHandle);case"keyPairGeneration":return n.add(t.keyPair.publicKey.keyHandle,t.keyPair.publicKey.keyData),n.add(t.keyPair.privateKey.keyHandle,t.keyPair.privateKey.keyData),{publicKey:t.keyPair.publicKey.keyHandle,privateKey:t.keyPair.privateKey.keyHandle};default:throw new Error("Unknown key operation");}return}return c(t)}function w(n){function i(n){return l(n)}var t=c(i);return t.process=function(t){n.operationSubType="process";n.buffer=u.toArray(t);f.continueJob(this,u.clone(n))},t.finish=function(){n.operationSubType="finish";n.buffer=[];f.continueJob(this,u.clone(n))},t.abort=function(){f.abortJob(this)},t.onabort=null,t.onprogress=null,t.algorithm=n.algorithm||null,t.key=n.keyHandle||null,t}function l(n){return kt&&n.pop?new Uint8Array(n).buffer:n}function b(n){if(n.oncomplete)n.oncomplete({target:n});else setTimeout(function(){b(n)},y)}function d(n,i){if(!t.exists(n,i))throw new Error("unsupported algorithm");}function e(t){var i=n.lookup(t);if(!i)throw new Error("key not found");return i}function g(n,t){for(var f,r,e={operationType:n},s=v[n],o=0;o<s.length;o+=1){if(f=a[s[o]],r=t[o],!r)if(f.required)throw new Error(f.name);else continue;if(r.subarray&&(r=u.toArray(r)),i.getObjectType(r)!==f.type)throw new Error(f.name);f.name==="algorithm"&&(r.name=r.name.toLowerCase(),r.iv&&(r.iv=u.toArray(r.iv)),r.salt&&(r.salt=u.toArray(r.salt)),r.additionalData&&(r.additionalData=u.toArray(r.additionalData)),r.hash&&!r.hash.name&&i.getObjectType(r.hash)=="String"&&(r.hash={name:r.hash}));e.hasOwnProperty(f.name)?e[f.name+"1"]=r:e[f.name]=r}return e}function r(n,t,i){var r=g(n,t),u;return d(n,r.algorithm.name),r.keyHandle&&(r.keyData=e(r.keyHandle)),r.keyHandle1&&(r.keyData1=e(r.keyHandle1)),r.algorithm&&r.algorithm.publicKey&&(r.additionalKeyData=e(r.algorithm.publicKey)),u=i?p(r):w(r),(i||r.buffer||n==="deriveBits"||n==="wrapKey")&&f.runJob(u,r),u}var y=100,n=[],f,u,a,v,o;return n.add=function(t,i){n.push({keyHandle:t,keyData:i})},n.remove=function(t){for(var i=0;i<n.length;i++)if(n[i].keyHandle===t){n=n.splice(i,1);return}},n.lookup=function(t){for(var i=0;i<n.length;i++)if(n[i].keyHandle===t)return n[i].keyData;return null},f=function(){function p(){w(!tt);for(var t=0;t<n.length;t++)if(!n[t].busy)return n[t];return null}function w(t){for(var i=n.length-1;i>=0;i-=1)n[i].isWebWorker===t&&(n[i].terminate(),n.splice(i,1))}function b(){for(var i=0,t=0;t<n.length;t++)n[t].busy||(i+=1);return i}function k(t){n.push(t)}function r(t){for(var i=0;i<n.length;i++)if(n[i]===t){t.terminate();n.splice(i,1);return}}function u(t){for(var i=0;i<n.length;i++)if(n[i].operation===t)return n[i];return null}function f(n,i){t.push({operation:n,data:i,id:y++})}function e(n){if(n.busy=!1,n.operation=null,tt)if(t.length>0){var i=t.shift();l(i.operation,i.data)}else b()>v&&r(n)}function d(n){var r;if(tt)try{r=new Worker(at);r.postMessage({prngSeed:s.getBytes(48)});r.isWebWorker=!0}catch(u){tt=!1;o.forceSync=!0;r=h();r.isWebWorker=!1}else r=h(),r.isWebWorker=!1;return r.operation=n,r.busy=!1,r.onmessage=function(n){for(var o,f=r.operation,u=0;u<t.length;u++)if(t[u].operation===r.operation){o=t[u];t.splice(u,1);i(r,o.data);return}f&&n.data.type!=="process"&&(e(r),f.dispatchEvent(n))},r.onerror=function(n){var t=r.operation;e(r);t.dispatchEvent(n)},k(r),r}function g(n){var t=u(n);t&&r(t)}function c(t,r){var u=null;if(tt=vt&&!o.forceSync,u=p(),tt&&u===null&&n.length>=a){f(t,r);return}if(u===null&&(u=d(t)),u===null){f(t,r);throw new Error("could not create new worker");}u.operation=t;u.busy=!0;i(u,r)}function l(n,t){var r=u(n);if(r){i(r,t);return}c(n,t)}function i(n,t){tt?(n.data=t,n.postMessage(t)):setTimeout(function(){n.postMessage(t)},0)}var a=15,v=4,n=[],t=[],y=0;return{runJob:c,continueJob:l,abortJob:g}}(),u=i,a=[{name:"algorithm",type:"Object",required:!0},{name:"keyHandle",type:"Object",required:!0},{name:"buffer",type:"Array",required:!1},{name:"signature",type:"Array",required:!0},{name:"format",type:"String",required:!0},{name:"keyData",type:"Array",required:!0},{name:"extractable",type:"Boolean",required:!1},{name:"keyUsages",type:"Array",required:!1},{name:"derivedKeyType",type:"Object",required:!0},{name:"length",type:"Number",required:!1}],v={encrypt:[0,1,2],decrypt:[0,1,2],sign:[0,1,2],verify:[0,1,3,2],digest:[0,2],generateKey:[0,6,7],importKey:[4,5,0,6,7],exportKey:[0,4,1,6,7],deriveKey:[0,1,8,6,7],deriveBits:[0,1,9],wrapKey:[1,1,0],unwrapKey:[2,0,1,6,7]},o={encrypt:function(){return r("encrypt",arguments,0)},decrypt:function(){return r("decrypt",arguments,0)},sign:function(){return r("sign",arguments,0)},verify:function(){return r("verify",arguments,0)},digest:function(){return r("digest",arguments,0)},generateKey:function(){return r("generateKey",arguments,1)},deriveKey:function(){return r("deriveKey",arguments,1)},deriveBits:function(){return r("deriveBits",arguments,0)},importKey:function(){return r("importKey",arguments,1)},exportKey:function(n,t){return r("exportKey",[t.algorithm,n,t],1)},wrapKey:function(){return r("wrapKey",arguments,0)},unwrapKey:function(){return r("unwrapKey",arguments,1)}}}()),lt=function(){function t(t){var w=r(t.keyData1,t.keyHandle1.algorithm.name,c["sha-1"]),u=128,b=l.keyToJwk(t.keyHandle,t.keyData),k={alg:t.keyHandle1.algorithm.name.toUpperCase(),enc:"A128GCM"},f=n.toBase64(JSON.stringify(k),!0),e=s.getBytes(32),d=w.encrypt(e),o=n.toBase64(d,!0),h=s.getBytes(12),a=n.toBase64(h,!0),nt=f.concat(".",o,".",a),v=y(g.aes(e));v.init(h,n.stringToBytes(nt),u);var i=v.encrypt(b),p=i.slice(-(u/8)),tt=n.toBase64(p,!0),it=n.toBase64(i.slice(0,i.length-p.length),!0),rt={recipients:[{header:f,encrypted_key:o,integrity_value:tt}],initialization_vector:a,ciphertext:it};return n.stringToBytes(JSON.stringify(rt))}function u(t){var u=n.base64ToBytes,i=JSON.parse(String.fromCharCode.apply(null,t.buffer)),d=n.base64ToString(i.recipients[0].header),s=u(i.recipients[0].encrypted_key),h=u(i.recipients[0].integrity_value),a=u(i.initialization_vector),v=u(i.ciphertext),p=c["sha-1"],w=r(t.keyData,t.keyHandle.algorithm.name,p),b=w.decrypt(s),k=i.recipients[0].header.concat(".",i.recipients[0].encrypted_key,".",i.initialization_vector),e=y(g.aes(b)),o,f;return e.init(a,n.stringToBytes(k),128),o=e.decrypt(v,h),f=l.jwkToKey(o,t.algorithm,["k"]),{type:"keyImport",keyData:f.k,keyHandle:{algorithm:{name:t.algorithm.name},extractable:t.extractable||f.extractable,keyUsage:null||t.keyUsages,type:"secret"}}}var n=i;return{wrapKey:t,unwrapKey:u}}(),typeof t!="undefined"&&(t.register("wrapKey","aes-gcm",lt.wrapKey),t.register("unwrapKey","aes-cbc",lt.unwrapKey)),ht={subtle:pt,getRandomValues:function(n){for(var i=s.getBytes(n.length),t=0;t<n.length;t+=1)n[t]=i[t];return n},initPrng:function(n){var t=Object.prototype.toString.call(n);if(t!=="[object Array]"&&t!=="[object Uint8Array]")throw new Error("entropyData must be a Array or Uint8Array");ft&&ft.reseed(n);s.reseed(ft.read(48));bt=!0},toBase64:function(n){return i.toBase64(n,!1)},base64ToString:function(n){return i.base64ToString(n)},url:at},typeof n!="undefined"&&(ht.cryptoMath=n),typeof testInterface!="undefined"&&(ht.testInterface=testInterface),ot||(ft=ft||new ni,ft.init(),wt=ft.read(48),s.init(wt)),ht}();